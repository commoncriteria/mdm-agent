<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../transforms/module/module2html.xsl"?>
<?xml-model href="../transforms/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>

 

<Module boilerplate="yes" 
  target-product="MDM Agent" 
  target-products="MDM Agents"
  name="PP-Module for Mobile Device Management Agent"
  xmlns="https://niap-ccevs.org/cc/v1"
  xmlns:sec="https://niap-ccevs.org/cc/v1/section"
  xmlns:h="http://www.w3.org/1999/xhtml">
  
  <PPReference>
    <ReferenceTable>
      <PPVersion>2.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2025-01-31</PPPubDate>
      <Keywords>Mobile Device Management; MDM; MDM Agents</Keywords>
    </ReferenceTable>
  </PPReference>
  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2019-03-01</date>
      <subject><!-- TODO: Add description of what we changed in this version --> Initial publication as
        PP-Module. </subject>
    </entry>
    <entry>
      <version>1.1</version>
      <date>2023-12-11</date>
      <subject>
        Added GPOS PP base and incorporated NIAP Technical Decisions.
      </subject>
    </entry>
    <entry>
      <version>2.0</version>
      <date>2025-01-31</date>
      <subject>
        Converted to CC:2022 and incorporated NIAP Technical Decisions.
      </subject>
    </entry>
  </RevisionHistory>
  
  
  <include-pkg id="pkg-tls">
    <git>
      <url>https://github.com/commoncriteria/tls</url>
      <branch>master</branch>
    </git>
    <url>https://www.niap-ccevs.org/static_html/protection-profile/439/-439-/index.html</url>
  </include-pkg>
  <include-pkg id="pkg-x509">
    <git>
      <url>https://github.com/commoncriteria/X509</url>
      <branch>master</branch>
    </git>
    <url><![CDATA[https://www.niap-ccevs.org/protectionprofiles/511]]></url>
  </include-pkg>
  
  <sec:Introduction>
    <section id="overview" title="Overview"> The scope of the MDM Agent Protection Profile Module (PP-Module) is to describe the security functionality of a Mobile Device Management (MDM) Agent 
      in terms of Common Criteria (CC) and to define functional and assurance requirements for such products. 
      This PP-Module is intended for use with the following Base-PPs: <h:ul>
        <h:li>Protection Profile for Mobile Device Management (MDM PP), Version 5.0</h:li>
        <h:li>Protection Profile for Mobile Device Fundamentals (MDF PP), Version 4.0</h:li>
        <h:li>Protection Profile for General Purpose Operating Systems (GPOS PP), Version 5.0</h:li>
      </h:ul>
      <h:br/> These Base-PPs are valid because an MDM Agent is
      either a third-party application manufactured by the MDM Server vendor or is a
      native application deployed on a mobile device or GPOS. </section>

      <tech-terms>
        <suppress>TSF Interface</suppress>
            <term full="Administrator">The person who is responsible for management activities, including setting
            the policy that is applied by the enterprise on the device.</term>
	    <term abbr="API" full="Application Programming Interface"/>
	    <term abbr="BYOD" full="Bring Your Own Device"/>
	    <term abbr="DN" full="Distinguished Name"/>
	    <term abbr="DTLS" full="Datagram Transport Layer Security"/>
            <term full="Enrolled State">The state in which a device is managed by a policy from an MDM.</term>
	    <term abbr="GPOS" full="General Purpose Operating System"> A class of OSes designed to support a wide-variety of workloads consisting of many concurrent applications or services. Typical characteristics for OSes in this class include support for third-party applications, support for multiple users, and security separation between users and their respective resources. General Purpose Operating Systems also lack the real-time constraint that defines Real Time Operating Systems which are typically used in routers, switches, and embedded devices.</term>
	    <term abbr="HTTPS" full="Hypertext Transfer Protocol Secure"/>
      <term full="Managed Device" abbr="MD">A device enrolled and managed, or to be enrolled and managed, by an MDM system. This device is a mobile device typically evaluated under the MDF PP or a device utilizing a GPOS typically evaluated under the GPOS PP.</term>
      <term full="Mobile Application Store" abbr="MAS">An MDM feature that allows for an organization to substitute a device manufacturer's
            application store for one that restricts what applications are made available to users.</term>
      <term full="Mobile Device">A device which is composed of a hardware platform and its system software. The device typically provides wireless
				connectivity and may include software for functions like secure messaging, email, web, VPN connection, and VoIP (Voice over IP), for access
				to the protected enterprise network, enterprise data and applications, and for communicating to other MDs.</term>
      <term full="Mobile Device Management" abbr="MDM">Products that allow enterprises to apply security policies to end user devices. This system consists of two primary
          components: the MDM Server and the MDM Agent.</term>
      <term full="Managed Device User">The person who uses and is held responsible for a managed device. Synonymous with 'local user' in the context
              of a managed device.</term>
	    <term abbr="MDF" full="Mobile Device Fundamentals"/>
            <term abbr="OS" full="Operating System">
	      Software which runs at the highest privilege level and can directly control
              hardware resources. These include mobile device and general purpose operating systems (GPOS).
              Mobile device operating systems have general purpose functionality but are typically integrated more tightly with purpose-built
              mobile hardware and limit a user's ability to interact with the operating system.
              Modern mobile devices typically have at least two primary
              operating systems: one which runs on the cellular baseband processor and one which
              runs on the application processor. The platform of the application processor handles
              most user interaction and provides the execution environment for apps. The platform of
              the cellular baseband processor handles communications with the cellular network and
              may control other peripherals. The term OS, without context, may be assumed to refer
              to the platform of the application.</term>
	      <term abbr="TLS" full="Transport Layer Security"/>
              <term full="Unenrolled State">
		The state in which a device is not managed by an MDM system.
	      </term>
              <term full="User">See Managed Device User.</term>
      </tech-terms>

    <section id="targets" title="Compliant Targets of Evaluation"> 
      The MDM system
      consists of two primary components: the MDM Server software and the MDM Agent. This PP-Module specifically addresses the MDM Agent, 
      which establishes a secure connection back
      to the MDM Server, from which it receives policies to enforce on the 
      device. Optionally, the MDM Agent interacts with a MAS Server to download and install enterprise-hosted applications.
      <h:br/><h:br/> 
      A compliant MDM Agent is installed on a device as an application
      (supplied by the developer of the MDM Server software) or is part of a mobile device or GPOS. This PP-Module builds on the MDF PP, the MDM PP, or the GPOS PP. A TOE
      that claims conformance to this PP-Module must also claim conformance to one
      of those PPs as its Base-PP. To mitigate the threats that this PP-Module defines, a compliant TOE is obligated to implement the functionality the 
      Base-PP requires, along with the additional functionality defined in this PP-Module.
      <h:br/><h:br/> 
      This PP-Module shall build on the MDF PP if the 
      TOE is a native part of a mobile operating system. The TOE for
      this PP-Module combined with the MDF PP is the mobile
      device itself plus the MDM Agent. If the MDM Agent is part
      of the MD’s OS, the MDM Agent may present multiple interfaces for
      configuring the MD, such as a local and remote interface. MDM Agents
      conforming to this PP-Module must at least offer an interface with a trusted
      channel that serves as one piece of an MDM system. Conformant MDM Agents may also offer other interfaces, and the configuration aspects of
      these additional interfaces are in scope of this PP-Module.
      <h:br/><h:br/> 
      This PP-Module shall build on the MDM PP if the TOE is a third-party application that is provided with
      an MDM Server and installed on a device by the user after acquiring
      the device. The distributed TOE for this PP-Module
      combined with the MDM PP is the entire MDM environment, which includes both the MDM Server and the
        MDM Agent. Even though the device itself is not part of the TOE, it is expected to be evaluated against the MDF or GPOS PP so that
      its baseline security capabilities can be assumed to be present. If the TOE conforms to the GPOS PP, evaluating the hardware platform against
      the Protection Profile for General Purpose Computing Platforms (GPCP PP) may also be considered so that assurance of the underlying platform hardware
      can be obtained.
      <h:br/><h:br/>
      This PP-Module shall build on the GPOS PP if the TOE is a native part of a non-mobile GPOS.
      The TOE for this PP-Module combined with the GPOS PP is the operating system itself plus the MDM Agent. If the MDM Agent is part of 
      the OS, the MDM Agent may present multiple interfaces for configuring the OS, such as a local and remote interface. 
      The MDM Agent does not need to provide a dedicated management interface that is separate from the means by which administrators interact with the 
      OS as a whole. However, if it does provide any such interfaces, the configuration aspects of these additional interfaces are in scope of this PP-Module.
      
      <section title="TOE Boundary" id="TOEboundary"> Figure 1 shows a high-level example of the PP-Module
        TOE boundary and its OE where the TOE runs on a mobile device. A use case where the TOE runs on a GPOS
        is identical aside from the specific type of device on which it runs. As stated above, the MDM Agent may either be provided as part of the device itself (shown in
        red) or distributed as a third-party application from the developer of the MDM Server software (shown in blue).<h:br/><h:br/>
        <figure entity="images/MDMAgentSystem.png"
          title="MDM Agent Operating Environment" id="toe"/><h:br/> 
        The MDM
        Agent must closely interact with or be part of the mobile device or OS platform so that it can
        establish policies and to perform queries about device status. The mobile device and OS platform, in turn,
        have their own security requirements specified in the MDF PP and GPOS PP, respectively. 
        </section>
    </section>
    <section title="Use Cases" id="usecase"> This PP-Module defines four use cases:<h:br/><h:br/>
      <usecases>
        <usecase title="Enterprise-owned device for general-purpose enterprise use" id="usecase1">
          <description> An enterprise-owned device for general-purpose business use is commonly
            called Corporately Owned, Personally Enabled. This use case entails a significant
            degree of enterprise control over configuration and software inventory. Enterprise
            administrators use an MDM product to establish policies on the 
            devices prior to user issuance. Users may use internet connectivity to browse the web, 
            access corporate mail, or run enterprise applications, but this connectivity may be under
            significant control of the enterprise. The user may also be expected to store data and
            use applications for personal, non-enterprise use. The enterprise administrator uses the
              MDM product to deploy security policies and query device
            status. The MDM may issue commands for remediation actions.
          </description>
        </usecase>
        <usecase title="Enterprise-owned device for specialized, high-security use" id="usecase2">
          <description>An enterprise-owned device with intentionally limited network connectivity,
            tightly controlled configuration, and limited software inventory is appropriate for
            specialized, high-security use cases. As in the previous use case, the MDM product is used 
            to establish such policies on devices prior to
            issuance to users. The device may not be permitted connectivity to any external
            peripherals. It may only be able to communicate via its Wi-Fi or cellular radios with
            the enterprise-run network, which may not even permit connectivity to the internet. Use
            of the device may require compliance with usage policies that are more restrictive than
            those in any general-purpose use case, yet may mitigate risks to highly sensitive
            information.
          </description>
          <config>
            <ref-id>change-in-enrollment-state</ref-id>
            <ref-id>prevent-unenrollment</ref-id>
          </config>
        </usecase>
        <usecase title="Personally owned device for personal and enterprise use" id="usecase3">
          <description>A personally owned device, which is used, for both personal activities and
            enterprise data is commonly called Bring Your Own Device (BYOD). The device may be
            provisioned for access to enterprise resources after significant personal usage has
            occurred. Unlike in the enterprise-owned cases, the enterprise is limited in what
            security policies it can enforce because the user purchased the device primarily for
            personal use and is unlikely to accept policies that limit the functionality of the
            device.<h:br/><h:br/> However, because the enterprise allows the user full (or
            nearly full) access to the enterprise network, the enterprise will require certain
            security policies, for example a password or screen lock policy, and health reporting,
            such as the integrity of the system software, before allowing access. The
            administrator of the MDM can establish remediation actions, such as
            wiping enterprise data for non-compliant devices. These controls could potentially
            be enforced by a separation mechanism built-in to the device itself to distinguish
            between enterprise and personal activities, or by a third-party application that
            provides access to enterprise resources and leverages security capabilities provided by
            the device.
          </description>
          <config>
            <ref-id>apply-remediation</ref-id>
          </config>
        </usecase>
        <usecase title="Personally owned device for personal and limited enterprise use"
          id="usecase4">
          <description>A personally owned device may also be given access to limited enterprise
            services such as enterprise email. Because the user does not have full access to the
            enterprise or enterprise data, the enterprise may not need to enforce any security
            policies on the device. However, the enterprise may want secure email and web browsing
            with assurance that the services being provided to those clients by the device
            are not compromised. Based on the OE and the acceptable risk
            level of the enterprise, those SFRs outlined in Section 5 of this PP-Module are sufficient for the secure
            implementation of this BYOD use case.</description>
        </usecase>
      </usecases>
    </section>
    
    <section title="Implementation-Dependent Features" id="sec-features">
      If the TOE implements the following features, then the SFRs associated with the features must be claimed.
      <implements>
        <feature id="has-auditing" title="Platform Auditing">
          <description>If the TOE is deployed on a mobile device or GPOS platform (i.e., the TOE does not use 
            the MDM PP as its Base-PP), it is expected to rely on the underlying platform for secure storage of its audit records.</description>
        </feature>
        <feature id="supports-reachability" title="Supports Network Reachability Thresholds">
          <description>An MDM Agent may support the ability to determine if it has been out of connectivity with an MDM Server for too long.
            The configuration of the number of allowed missed reachability events or time limit since last successful connection
            with the MDM Server is handled in the MDM Server's configuration policy of the MDM Agent (the first selection of
            function 56 in FMT_SMF.1.1/SERVER_CONF_AGENT within the MDM PP). This feature applies if either the TOE claims the MDM PP as its 
            Base-PP and management function 56 is claimed, or if the TOE's OE includes an MDM Server that was separately validated against
            the MDM PP and that MDM Server's ST claims management function 56.</description>
        </feature>
      </implements>
    </section>
    
  </sec:Introduction>
 
  
  
  <sec:Conformance_Claims boilerplate="no">
    <!-- The new CClaimsInfo construct -->
    <CClaimsInfo cc-version="cc-2022r1" cc-approach="direct-rationale">
      <cc-st-conf>exact</cc-st-conf>       
      <cc-pt2-conf>extended</cc-pt2-conf>
      <cc-pt3-conf>extended</cc-pt3-conf>
      <cc-pp-conf/>
      <cc-pp-config-with> 
        <PP-cc-ref>Protection Profile for General Purpose Operating Systems, Version 5.0</PP-cc-ref>
        <PP-cc-ref>Protection Profile for Mobile Device Fundamentals, Version 4.0</PP-cc-ref>
        <PP-cc-ref>Protection Profile for Mobile Device Management, Version 5.0</PP-cc-ref>
        <Mod-cc-ref>PP-Module for Virtual Private Network (VPN) Clients, version 3.0</Mod-cc-ref>  
        <Mod-cc-ref>PP-Module for Bluetooth, version 2.0</Mod-cc-ref>
        <Mod-cc-ref>PP-Module for WLAN Clients, version 2.0</Mod-cc-ref>
        <Mod-cc-ref>cPP-Module for Biometric Enrolment and Verification - for unlocking the device, version 1.1</Mod-cc-ref>        
      </cc-pp-config-with>
      <cc-pkg-claim>
        <FP-cc-ref conf="conformant">Functional Package for Transport Layer Security Version 2.1</FP-cc-ref>
        <FP-cc-ref conf="conformant">Functional Package for X.509 Version 1.0</FP-cc-ref>
        <AP-cc-ref conf="conformant">Assurance Package for Flaw Remediation Version 1.0</AP-cc-ref>
      </cc-pkg-claim>
    </CClaimsInfo>
    
    
  </sec:Conformance_Claims>
  <sec:Security_Problem_Definition>
    <sec:Threats> The following threats are specific to MDM Agents, and represents an addition to those identified in the Base-PPs. 
      <!-- Note: Threats contained in both base-PPs should not be listed in the PP-Module (section 3.1 or 6), but objectives can still be mapped to them (section 4.3). 
        For these threats do not include a <description> or <consistency-rationale> section. If a <description> section is included then the threat is listed in Section 3.1. 
        If no description is listed, then threat is only listed in section 4.3 (not in 3.1 or 6) -->
      <threats>
  
        <threat name="T.INSECURE_MDM_COMMUNICATIONS">
          <description>
            A malicious user or process may inspect network communications between the MDM agent and an MDM server to illicitly determine, modify, or prevent these communications in such a way that the MDM agent fails to enforce the intended policy.
          </description>
          <addressed-by>FTP_ITC_EXT.1/MDFCHANNEL (additional to MDF PP)</addressed-by><rationale>Mitigates the threat of insecure communications by defining the use of a trusted channel to communicate with an MDM server for transmission of policies.</rationale>
          <addressed-by>FTP_TRP.1/MDFENROLL (additional to MDF PP)</addressed-by><rationale>Mitigates the threat of insecure communications by defining the use of a trusted channel to communicate with an MDM server for enrollment into management.</rationale>
          <addressed-by>FTP_ITC_EXT.1/OSCHANNEL (additional to GPOS PP)</addressed-by><rationale>Mitigates the threat of insecure communications by defining the use of a trusted channel to communicate with an MDM server for transmission of policies.</rationale>
          <addressed-by>FTP_TRP.1/OSENROLL (additional to GPOS PP)</addressed-by><rationale>Mitigates the threat of insecure communications by defining the use of a trusted channel to communicate with an MDM server for enrollment into management.</rationale>
        </threat>

        
        <threat name="T.MISUSED_DEVICE">
          <description>
            A malicious or careless user may operate a MD in such a way that it compromises the security of the device, its data, or its user.
          </description>
          <addressed-by>FAU_ALT_EXT.2</addressed-by><rationale>Mitigates the threat of a misused device by causing the generation of alerts based on the usage of the device.</rationale>
          <addressed-by>FAU_GEN.1/AGENT</addressed-by><rationale>Mitigates the threat of a misused device by generating audit events regarding the use and behavior of the MDM agent.</rationale>
          <addressed-by>FAU_SEL.1/AGENT</addressed-by><rationale>Mitigates the threat of a misused device by allowing the activity that triggers audit events for MDM agent behavior.</rationale>
          <addressed-by>FMT_UNR_EXT.1</addressed-by><rationale>Mitigates the threat of a misused device by preventing the unenrollment of the device from management or by taking some other security-relevant action if unenrollment is performed.</rationale>
          <addressed-by>FPT_NET_EXT.1 (implementation-dependent)</addressed-by><rationale>Mitigates the threat of a misused device by tracking when the device has lost contact with the MDM server as a basis for triggering automatic fail-safe behavior.</rationale>
          <addressed-by>FAU_STG_EXT.3 (implementation-dependent)</addressed-by><rationale>Mitigates the threat of a misused device by using trusted platform storage to protect against destruction of evidence related to misuse.</rationale>
        </threat>
        
        <threat name="T.UNAUTHORIZED_POLICY_SOURCE">
          <description>
          A malicious user or process can send illegitimate policy data to the TOE in an attempt to cause it to enter an insecure or unknown state.
          </description>
          <addressed-by>FCS_STG_EXT.4 (additional to MDF PP)</addressed-by><rationale>Mitigates the threat of an unauthorized policy source by preventing substitution of the valid policy source.</rationale>
          <addressed-by>FCS_STG_EXT.1/MDMKEYS (additional to MDM PP)</addressed-by><rationale>Mitigates the threat of an unauthorized policy source by preventing substitution of the valid policy source.</rationale>
          <addressed-by>FIA_ENR_EXT.2</addressed-by><rationale>Mitigates the threat of an unauthorized policy source by recording the identifier of the MDM server that it enrolled to.</rationale>
          <addressed-by>FMT_POL_EXT.2</addressed-by><rationale>Mitigates the threat of an unauthorized policy source by applying only policies that are digitally signed by an authorized source.</rationale>
          <addressed-by>FMT_SMF_EXT.4</addressed-by><rationale>Mitigates the threat of an unauthorized policy source by requiring authorization by the underlying platform to manage the TSF.</rationale>
        </threat>
         
      </threats>
    </sec:Threats>
    <section id="Assumptions" title="Assumptions">
      <assumptions>
        <assumption name="A.CONNECTIVITY">
          <description>The TOE relies on network connectivity to carry out its
            management activities. The TOE will robustly handle instances when
            connectivity is unavailable or unreliable. </description>
          <objective-refer ref="OE.WIRELESS_NETWORK">
            <rationale>The OE objective OE.WIRELESS_NETWORK is realized through
              A.CONNECTIVITY. </rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.PLATFORM">
          <description>The MDM Agent relies upon platform and hardware functionality
            that can be assumed to provide policy enforcement, cryptographic services, 
            data protection, trusted updates, and software integrity verification of the MDM Agent. </description>
          <objective-refer ref="OE.DEVICE_PLATFORM">
            <rationale>The OE objective OE.DEVICE_PLATFORM is realized
              through A.PLATFORM. </rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.PROPER_ADMIN">
          <description>One or more competent, trusted personnel who are not careless, willfully
            negligent, or hostile, are assigned and authorized as the TOE
            administrators, and do so using and abiding by guidance documentation. </description>
          <objective-refer ref="OE.DATA_PROPER_ADMIN">
            <rationale>The OE objective OE.DATA_PROPER_ADMIN is realized
              through A.PROPER_ADMIN. </rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.PROPER_USER">
          <description>Users are not willfully negligent or hostile, and use the
            device within compliance of a reasonable enterprise security policy. </description>
          <objective-refer ref="OE.DATA_PROPER_USER">
            <rationale>The OE objective OE.DATA_PROPER_USER is realized through
              A.PROPER_USER. </rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </section>
    <section id="securityPolicy" title="Organizational Security Policies" boilerplate="no">
      <OSPs>
        <OSP name="P.ACCOUNTABILITY">
          <description>Personnel operating the TOE shall be accountable for their
            actions within the TOE. </description>
          <objective-refer ref="OE.DEVICE_PLATFORM">
            <rationale>The use of a trusted device platform will include the necessary mechanisms to record user actions.</rationale>
          </objective-refer>
        </OSP>
        <OSP name="P.ADMIN">
          <description>The configuration of the device's security functions must adhere to the
            enterprise security policy. </description>
          <objective-refer ref="OE.DATA_PROPER_ADMIN">
            <rationale>An environment that empowers only trusted administrators will satisfy the policy that the device is configured correctly.</rationale>
          </objective-refer>
        </OSP>
        <OSP name="P.DEVICE_ENROLL">
          <description>The MDM administrator must enroll a device for a specific user prior to it 
            being used in the enterprise network. </description>
          <objective-refer ref="OE.DATA_PROPER_ADMIN">
            <rationale>An environment that empowers only trusted administrators will satisfy the policy that the device is enrolled into management.</rationale>
          </objective-refer>
          <objective-refer ref="OE.IT_ENTERPRISE">
            <rationale>The use of an enterprise IT network enables the infrastructure to facilitate device enrollment.</rationale>
          </objective-refer>
        </OSP>
        <OSP name="P.NOTIFY">
          <description>The user must immediately notify the administrator if a device
            is lost or stolen so that the administrator may apply remediation actions via the MDM system. </description>
          <objective-refer ref="OE.DATA_PROPER_USER">
            <rationale>An environment with trained and trusted users can be expected to adhere to this policy.</rationale>
          </objective-refer>
        </OSP>
      </OSPs>
    </section>
    </sec:Security_Problem_Definition>
  <sec:Security_Objectives>
   
    <section id="objectivesEnvironment" title="Security Objectives for the Operational Environment">
      <SOEs>
        <SOE name="OE.DATA_PROPER_ADMIN">
          <description>TOE administrators are trusted to follow and apply all administrator guidance
            in a trusted manner. </description>
          <consistency-rationale><!-- Note: different per base, so defined as a con-mod under each base--></consistency-rationale>
        </SOE>
        <SOE name="OE.DATA_PROPER_USER">
          <description>Device users are trained to securely use the device running the MDM Agent and
            apply all guidance in a trusted manner. </description>
          <consistency-rationale><!-- Note: different per base, so defined as a con-mod under each base--></consistency-rationale>
        </SOE>
        <SOE name="OE.IT_ENTERPRISE">
          <description>The enterprise IT infrastructure provides security for a network that is
            available to the TOE and the device on which it runs that prevents unauthorized
            access. </description>
          <consistency-rationale><!-- Note: different per base, so defined as a con-mod under each base--></consistency-rationale>
        </SOE>
        <SOE name="OE.DEVICE_PLATFORM">
          <description>The MDM Agent relies upon the trusted platform
            and hardware to provide policy enforcement as well as cryptographic services and data
            protection. The platform also provides trusted updates and software integrity
            verification of the MDM Agent. </description>
          <consistency-rationale><!-- Note: different per base, so defined as a con-mod under each base--></consistency-rationale>
        </SOE>
        <SOE name="OE.WIRELESS_NETWORK">
          <description>A wireless network will be available to devices running the MDM Agent. </description>
          <consistency-rationale><!-- Note: different per base, so defined as a con-mod under each base--></consistency-rationale>
        </SOE>
      </SOEs>
    </section>
    <section title="Security Objectives Rationale" id="rationale">
      <!-- Note: This section should remain empty and is populated from the rationale tags in the previous sections.  -->
    </section>
  </sec:Security_Objectives>
  <sec:Security_Requirements title="Security Requirements">
    <base-pp id="bpp-mdf" name="Mobile Device Fundamentals" product="Mobile Device" short="MDF"
      version="4.0">
      <git>
        <url>https://github.com/commoncriteria/mobile-device</url>
        <branch>release-4.0</branch>
      </git>
      <url>https://www.niap-ccevs.org/static_html/protection-profile/468/MDF%203.3%20PP/index.html</url>
   
      <modified-sfrs/>
      <additional-sfrs>
        
        <!-- Audit table for Additional SFRs -->
        <section id="sec-at-mdf-addnl" title="Auditable Events for MDF PP Additional SFRs">
          <audit-table id="at-mdf-addnl" table="tab-at-mdf-addnl" title="Auditable Events for MDF PP Additional SFRs"/>
        </section>
        
        <sec:mdf_mod_fcs title="Cryptographic Support (FCS)">
          <ext-comp-def fam-id="FCS_STG_EXT" title="Trusted Channel">
            <mod-def> This family is defined in both the MDF and the MDM Base-PPs. This PP-Module augments the extended family by adding
              one additional component, FCS_STG_EXT.4 as an additional SFR for MDF. This new component and its impact on the extended 
              family’s component leveling are shown below; reference the MDF or MDM PP for all other
              definitions for this family.<h:br/><h:br/></mod-def> 
          </ext-comp-def> 
          <f-component cc-id="fcs_stg_ext.4" name="Cryptographic Key Storage">
            <consistency-rationale> This SFR requires the MDM Agent to use
              functionality defined by the Base-PP in FCS_CKM_EXT.1. </consistency-rationale>
            <comp-lev> requires the TSF to define a specific location for its key
              storage.</comp-lev>
            <management>There are no management functions foreseen.</management>
            <audit>There are no auditable events foreseen.</audit>
            <dependencies>FCS_CKM.1 Cryptographic Key Generation</dependencies>
            <f-element>
              <title>The MDM Agent shall use the platform provided key storage for
                all persistent secret and private keys.</title>
              <note role="application">This requirement ensures that persistent secrets
                (credentials, secret keys, authentication tokens) and private keys are stored securely when not in use by
                the mobile platform. </note>
              <aactivity>
                <TSS> 
                  <h:p>The evaluator shall verify that the TSS lists each persistent
                  secret (credential, secret keys, authentication tokens) and private keys needed to meet the requirements in
                  the ST. For each of these items, the evaluator shall confirm that
                  the TSS lists for what purpose it is used, and, for each
                  platform listed as supported in the ST, how it is stored. The
                  evaluator shall verify that the MDM Agent calls a platform-provided API to store
                  persistent secrets and private keys. 
                  </h:p>
                </TSS>
                <Guidance>
                  <h:p>There are no guidance EAs for this component.</h:p>
                </Guidance>
                <Tests>
                  <h:p>There are no test EAs for this component.</h:p>
                </Tests>
              </aactivity>
            </f-element>
            <audit-event table="tab-at-mdf-addnl"/>
          </f-component>
        </sec:mdf_mod_fcs>
        <sec:mdf_mod_ftp title="Trusted Path/Channels (FTP)">
          <f-component cc-id="ftp_itc_ext.1" name="Trusted Channel Communication" iteration="MDFCHANNEL">
            <consistency-rationale> The Base-PP includes FTP_ITC_EXT.1 to define the secure protocols used for trusted channel communications. This PP-Module iterates the SFR to specify a subset of these protocols that may be used for MDM Agent communications in particular. </consistency-rationale>
            <f-element id="mut-chan-type">
              <title>The TSF shall use <selectables linebreak="yes">
                <selectable>mutually authenticated TLS in accordance with [<h:i><xref to="pkg-tls"/></h:i>]</selectable>
                <selectable>mutually authenticated <h:b>DTLS</h:b> in accordance with [<h:i><xref to="pkg-tls"/></h:i>]</selectable>
                <selectable><h:b>HTTPS</h:b></selectable>
                </selectables> and [<h:i>no other protocols</h:i>] to provide a communication channel between itself and another trusted
                IT product that is logically distinct from other communication channels, provides
                assured identification of its end points, protects channel data from disclosure, and
                detects modification of the channel data.</title>
              <note role="application"> The intent of this requirement is to protect the
                communications channel between MDM Server and MDM Agent, post
                enrollment. FTP_TRP.1/MDFENROLL is to protect the communications
                channel between MDM Server and MDM Agent during enrollment.
                <h:br/><h:br/> This requirement is to ensure that the transmission of any audit
                logs, mobile device information data (software version, hardware model, and
                application versions), and configuration data collected by the MDM
                Agent and sent from the MDM Agent to the MDM
                Server, when commanded, or at configurable intervals, is properly protected. This
                trusted channel also protects any commands and policies sent by the MDM Server to the MDM Agent. 
                Either the MDM Agent or the MDM Server is able to initiate the
                connection.
                <h:br/><h:br/> 
                This requirement is iterated from the MDF PP to indicate the protocols that the MDM Agent can use for a trusted
                channel. The mobile device is required to perform the mandated cryptographic
                protocols as in the Base-PP for communication channels mandated in
                the MDF PP. The ST author must select one of
                TLS, DTLS, or HTTPS in order to establish and maintain a trusted channel between the
                  MDM Agent and the MDM Server. Only TLS, DTLS,
                or HTTPS are acceptable for this trusted channel.<h:br/><h:br/> Since this
                requirement is only for the case when the PP-Module builds on the MDF
                PP, and in this case it is expected that the MDM Agent will be a
                native part of the mobile operating system, it is expected that the MDM Agent will use the mobile device's implementation of the
                selected protocols. HTTPS (FCS_HTTPS_EXT.1) and TLS (FCS_TLSC_EXT.1) are already
                mandatory for an MDF ST. If "TLS" or "DTLS" is selected, the following selections from
                <xref to="pkg-tls"/> must be made: <h:ul>
                  <h:li>FCS_TLS_EXT.1: <h:ul>
                      <h:li>Either TLS or DTLS is selected depending on the selection made in
                        <xref to="mut-chan-type"/>.</h:li>
                      <h:li>Client must be selected.</h:li>
                    </h:ul>
                  </h:li>
                  <h:li>FCS_TLSC_EXT.1.1: <h:ul>
                      <h:li>The cipher suites selected must correspond with the algorithms and
                        hash functions allowed in FCS_COP.1 from the MDF PP.</h:li>
                      <h:li>Mutual authentication must be selected.</h:li>
                    </h:ul>
                  </h:li>
                </h:ul> Protocol, RBG, certificate validation, algorithm, and similar services may
                be met with platform provided services. <h:br/><h:br/>
              </note>
            </f-element>
            <f-element id="mut-chan-init">
              <title>The TSF shall permit the TSF <h:b>and the MDM
                Server and <selectables>
                  <selectable>MAS Server</selectable>
                  <selectable>no other IT entities</selectable>
                </selectables></h:b> to initiate communication via the trusted channel.</title>
              <note role="application"> For all other use cases, the mobile device initiates the
                communication; however, for MDM Agents, the MDM
                Server may also initiate communication.</note>
            </f-element>
            <f-element id="mut-chan-all-none">
              <title>The TSF shall initiate communication via the trusted channel for <h:b>all
                communication between the MDM Agent and the MDM Server and <selectables>
                  <selectable>all communication between the MAS Server and the MDM
                    Agent</selectable>
                  <selectable>no other communication</selectable>
                </selectables></h:b>.
              </title>
              <note role="application"> This element is iterated from the MDF PP;
                it is expected that the mobile device will initiate the trusted channel between the MDM
                Agent and the MDM Server for administrative communication and may initiate other
                trusted channels to other trusted IT entities for other uses.</note>
              <aactivity>
                <TSS>The evaluator shall examine the TSS to determine that the
                  methods of communication between the MDM Agent and MDM Server (and MAS Server, if claimed) are indicated, along with how those
                  communications are protected. The evaluator shall also confirm that all protocols
                  listed in the TSS in support of remote TOE
                  administration are consistent with those specified in the requirement, and are
                  included in the requirements in the ST.<h:br/><h:br/>
                </TSS>
                <Guidance> The evaluator shall confirm that the operational guidance contains
                  instructions for configuring the communication channel between the MDM Agent and
                  the MDM Server and conditionally, the MAS Server for each supported
                  method.<h:br/><h:br/>
                </Guidance>
                <Tests>For each supported identifier type (excluding Distinguished Names [DNs], the evaluator shall
                  repeat the following tests:<h:br/><h:br/>
                  <testlist>
                    <test>The evaluator shall ensure that communications using each method that is specified in the operational guidance is tested during
                      the course of the evaluation, connections are set up as described in the operational guidance, and that communication is successful.
                    </test>
                    <test>The evaluator shall ensure, for each method of communication between the MDM Server (and MAS Server, if claimed),
                      the channel data is not sent in plaintext.
                    </test>
                    <test>The evaluator shall ensure, for each communication channel with the MDM
                      Server (and MAS Server, if claimed), that a protocol analyzer identifies the traffic as the protocol under
                      testing.
                    </test>
                  </testlist> 
                    <h:br/>
                    Further evaluation activities are associated with the specific protocols.<h:br/><h:br/>
                </Tests>
              </aactivity>
            </f-element>
            <audit-event table="tab-at-mdf-addnl">
              <audit-event-descr>Initiation of the trusted channel.</audit-event-descr>
              <audit-event-info>No additional information.</audit-event-info>
            </audit-event>
            <audit-event table="tab-at-mdf-addnl">
              <audit-event-descr>Termination of the trusted channel.</audit-event-descr>
              <audit-event-info>No additional information.</audit-event-info>
            </audit-event>
            <audit-event table="tab-at-mdf-addnl">
              <audit-event-descr>Failure of the trusted channel functions.</audit-event-descr>
              <audit-event-info>No additional information.</audit-event-info>
            </audit-event>
          </f-component>
          <f-component cc-id="ftp_trp.1" name="Trusted Path (for Enrollment)" iteration="MDFENROLL">
            <consistency-rationale>This SFR uses the trusted channel protocols defined by the Base-PP in FTP_ITC_EXT.1 to facilitate a trusted path that the 
              MDM Agent can use to enroll the mobile device it runs on into
              management. Even though the Base-PP does not define FTP_TRP.1, the
              requirement was given an iteration label for consistency with the MDM
              Server requirement of the same name. </consistency-rationale>
            <f-element>
              <title>The TSF shall <h:b>use <selectables linebreak="yes">
                  <selectable id="TRP_TLS_2">TLS client as defined in the Package for Transport Layer Security</selectable>
                  <selectable id="TRP_HTTPS_2">HTTPS</selectable>
              </selectables> </h:b>to provide a <h:b>trusted</h:b> communication path between itself and
                <h:b>an MDM Server</h:b>
                that is logically distinct from other communication paths and
                provides assured identification of its endpoints and protection of the communicated
                data from 
                [<h:i>modification, disclosure</h:i>]. </title>
            </f-element>
            <f-element>
              <title>The TSF shall permit [<h:i>local users</h:i>] to initiate communication via the trusted path.
              </title>
            </f-element>
            <f-element>
              <title>The TSF shall require the use of the trusted path for [<h:i>[MDM enrollment]</h:i>]. 
              </title>
              <note role="application">This requirement ensures that a trusted connection is used for initial enrollment to an MDM;
                security of ongoing MDM Server communications after enrollment is
                implemented through FTP_ITC_EXT.1/MDFCHANNEL.
                <h:br/><h:br/> The ST author chooses the mechanism or
                mechanisms supported by the TOE. The data passed in this trusted
                communication channel are encrypted as defined by the protocol selected.
                <h:br/><h:br/> Since this requirement is only for the case when the PP-Module builds on MDF PP, and in this case it is expected that the
                  MDM Agent will be a native part of the mobile operating system,
                it is expected that the MDM Agent will use the mobile device's
                implementation of the selected protocols. HTTPS (FCS_HTTPS_EXT.1) and TLS
                (FCS_TLSC_EXT.1) are already mandatory for an MDF ST. If "TLS" is selected,
                the following selections from <xref to="pkg-tls"/> must be made: <!-- TODO: What is their implementation of HTTPS evaluated against?? -->
                <!--  If "implement functionality to use HTTPS" is selected-->
                <h:ul>
                  <h:li>FCS_TLS_EXT.1: <h:ul>
                      <h:li>TLS or DTLS must be selected.</h:li>
                      <h:li>Client must be selected.</h:li>
                    </h:ul>
                  </h:li>
                  <h:li>FCS_TLSC_EXT.1.1: <h:ul>
                      <h:li>The cipher suites selected must correspond with the algorithms and
                        hash functions allowed in FCS_COP.1 from the MDF PP.</h:li>
                    </h:ul>
                  </h:li>
                </h:ul>
              </note>
              <aactivity>
                <TSS>The evaluator shall examine the TSS to determine that the
                  methods of remote enrollment are indicated, along with how those communications
                  are protected. The evaluator shall also confirm that all protocols listed in the
                    TSS in support of enrollment are consistent with those
                  specified in the requirement, and are included in the requirements in the ST.
                  <h:br/><h:br/>
                </TSS>
                <Guidance>The evaluator shall confirm that the operational guidance contains
                  instructions for establishing the enrollment sessions for each supported
                  method.<h:br/><h:br/>
                </Guidance>
                <Tests>For each enrollment method that the ST claims: <h:br/><h:br/>
                  <testlist>
                    <test>The evaluator shall ensure that communications using each specified (in
                      the operational guidance) enrollment method is tested during the course of the
                      evaluation, setting up the connections as described in the operational
                      guidance, and ensuring that communication is successful.
                    </test>
                    <test>For each method of enrollment supported, the evaluator shall follow the
                      operational guidance to ensure that there is no available interface that can
                      be used by a remote user to establish enrollment sessions without invoking the
                      trusted path.
                    </test>
                    <test>The evaluator shall ensure, for each method of enrollment, the channel data
                      is not sent in plaintext.
                    </test>
                  </testlist> 
                    <h:br/>
                    Further evaluation activities are associated with the specific protocols.<h:br/><h:br/>
                </Tests>
              </aactivity>
            </f-element>
            <audit-event table="tab-at-mdf-addnl">
              <audit-event-descr>Initiation of the trusted path.</audit-event-descr>
              <audit-event-info>No additional information.</audit-event-info>
            </audit-event>
            <audit-event table="tab-at-mdf-addnl">
              <audit-event-descr>Termination of the trusted path.</audit-event-descr>
              <audit-event-info>No additional information.</audit-event-info>
            </audit-event>
            <audit-event table="tab-at-mdf-addnl">
              <audit-event-descr>Failure of the trusted path functions.</audit-event-descr>
              <audit-event-info>No additional information.</audit-event-info>
            </audit-event>
          </f-component>
        </sec:mdf_mod_ftp>
      </additional-sfrs>
      <con-toe> When this PP-Module is used to extend the MDF PP, the TOE type for
        the overall TOE is still a mobile device. The TOE boundary is simply extended to include the
          MDM Agent application that runs on the mobile device.</con-toe>
      <con-sec-prob/>
      <con-obj/>
      <con-op-en/>
      <con-mod ref="T.INSECURE_MDM_COMMUNICATIONS">This threat exploits network connectivity, consistent with T.NETWORK_EAVESDROP and T.NETWORK_ATTACK threats defined in the Base-PP.
      </con-mod>
      <con-mod ref="T.MISUSED_DEVICE">This threat exploits issues with local device configuration, consistent with T.PHYSICAL_ACCESS and T.MALICIOUS_APP threats defined in the Base-PP.
      </con-mod>
      <con-mod ref="T.UNAUTHORIZED_POLICY_SOURCE">This threat exploits malicious configuration which is a mechanism by which the T.PERSISTENT_PRESENCE threat defined in the Base-PP can be realized.</con-mod>
        
      
      <con-mod ref="A.CONNECTIVITY">This assumption expects that networking services will be available for the TOE to use. 
        This is consistent with the Base-PP because the TOE is installed on a mobile device defined by the 
        Base-PP, which provides networking services through various radios.</con-mod>
      <con-mod ref="A.PLATFORM">This assumption expects that the TOE’s underlying platform is trustworthy. 
        This is consistent with the Base-PP by definition because a mobile device is within the TOE boundary and is evaluated against the MDF PP.</con-mod>
      <con-mod ref="A.PROPER_ADMIN">	
        This assumption expects that the TOE administrator is trusted and competent in configuring the TSF. 
        This assumption is consistent with the A.CONFIG assumption in the Base-PP, which expects the TSF to be configured correctly 
        regardless of the subject performing the configuration.</con-mod>
      <con-mod ref="A.PROPER_USER">	
        This assumption expects that the TOE user is not willfully negligent or hostile in using the TSF. 
        This assumption is consistent with the A.CONFIG assumption in the Base-PP, which expects the TSF 
        to be configured correctly regardless of the subject performing the configuration as well as the 
        A.NOTIFY and A.PRECAUTION assumptions which define baseline expectations for the user’s level of responsibility.</con-mod>
      
      <con-mod ref="P.ACCOUNTABILITY">The Base-PP does not define any OSPs so any OSPs defined by the PP-Module 
        will not conflict with the Base-PP by definition.</con-mod>
      <con-mod ref="P.ADMIN">The Base-PP does not define any OSPs so any OSPs defined by the PP-Module 
        will not conflict with the Base-PP by definition.</con-mod>
      <con-mod ref="P.DEVICE_ENROLL">The Base-PP does not define any OSPs so any OSPs defined by the PP-Module 
        will not conflict with the Base-PP by definition.</con-mod>
      <con-mod ref="P.NOTIFY">The Base-PP does not define any OSPs so any OSPs defined by the PP-Module 
        will not conflict with the Base-PP by definition.</con-mod>
      
     
      <con-mod ref="OE.DATA_PROPER_ADMIN"> This objective extends the Base-PP’s
        OE.CONFIG objective by expecting that TOE administrators act appropriately when installing
        or configuring the MDM Agent.</con-mod>
      <con-mod ref="OE.DATA_PROPER_USER"> This objective extends the Base-PP’s
        OE.NOTIFY and OE.PRECAUTION objectives by setting reasonable expectations for user security
        behavior.</con-mod>
      <con-mod ref="OE.IT_ENTERPRISE"> This objective helps mitigate the T.NETWORK_EAVESDROP and T.NETWORK_ATTACK
        threats defined by the Base-PP by reducing the network exposure of the
        mobile device. This does not conflict with the Base-PP because the Base-PP does not set specific expectations for the level of security that the
        enterprise provides. However, all use cases from the Base-PP set expectations
        that the mobile device is used for some enterprise purposes so it is reasonable to expect
        the enterprise have security controls in place to protect these functions. </con-mod>
      <con-mod ref="OE.DEVICE_PLATFORM"> This objective is suitable because the MDM Agent can reasonably expect the device it has been deployed on to be
        secure.</con-mod>
      <con-mod ref="OE.WIRELESS_NETWORK"> This objective is suitable because while the Base-PP does not define any availability metrics for wireless
        communications, the mobile device will always provide the ability to access a wireless
        network.</con-mod>
      <con-mod ref="fau-alt-ext-2"> This SFR requires the MDM Agent to use a
        trusted channel defined by FTP_ITC_EXT.1 in the Base-PP to transmit data
        about its own behavior to the OE.</con-mod>
      <con-mod ref="fau-gen-1-agent"> The Base-PP includes FAU_GEN.1; this PP-Module iterates the SFR to use the same audit mechanism to
        generate audit data for the MDM Agent’s behavior. It may alternatively
        allow the TSF to generate its own audit trail, which does not impede the MDF from enforcing
        its own security functionality.</con-mod>
      <con-mod ref="fau-sel-1-agent"> The Base-PP includes FAU_SEL.1; this PP-Module iterates the SFR to use the same audit mechanism to select
        the auditable events to be generated by the MDM Agent. Note that the Base-PP does not mandate this requirement so it is possible that only the
          MDM Agent portion of the TOE may implement it. In this case, the SFR
        provides a selection for the MDM Agent to implement its own mechanism to
        perform this function rather than a platform-provided one.</con-mod>
      <con-mod ref="fia-enr-ext-2"> This SFR requires the MDM Agent to record data
        that it receives from the OE. It does not need to use any functionality
        defined in the Base-PP to do this, and doing this does not prevent the
        enforcement of any security requirements from the Base-PP. </con-mod>
      <con-mod ref="fmt-pol-ext-2"> This SFR requires the MDM Agent to use a
        digital signature algorithm to validate data that it receives from the OE. 
        To do this, the MDM Agent will use the functionality defined
        by the Base-PP in FCS_COP.1/SIGN.</con-mod>
      <con-mod ref="fmt-smf-ext-4"> This SFR defines the ability of the MDM Agent
        to interact with the mobile device to execute the management functions defined by
        FMT_MOF_EXT.1 in the Base-PP. The Base-PP specifically
        indicates in FMT_MOF_EXT.1.2 that some management functions may be performed via
        MDM.</con-mod>
      <con-mod ref="fmt-unr-ext-1"> This SFR defines the functions performed by the MDM Agent when unenrolled from an MDM. The Base-PP defines 
        unenrollment actions in FMT_SMF_EXT.2, and goes on to note
        that these actions may be performed “perhaps via an MDM Agent,” so this is
        expected behavior. </con-mod>
      <con-mod ref="fau-stg-ext-3"> This SFR defines the ability of the MDM Agent
        to store generated audit data in the audit storage provided by the mobile device. The Base-PP defines the capability for 
        audit storage in FAU_STG.2.</con-mod>
      <con-mod ref="fpt-net-ext-1"> This SFR defines the ability of the MDM Agent
        to maintain information about its last successful connection with the environmental MDM Server 
        (i.e., the last successful invocation of the trusted channel for
        that interface, as defined in FTP_ITC_EXT.1 of the Base-PP). It does not
        need to use any functionality defined in the Base-PP to do this, and doing
        this does not prevent the enforcement of any security requirements from the Base-PP.</con-mod>
    </base-pp>
    <base-pp id="bpp-mdm" name="Mobile Device Management" short="MDM" product="MDM Server" version="4.0">
      <git>
        <url>https://github.com/commoncriteria/mdm</url>
        <branch>master</branch>
      </git>
      <url>https://www.niap-ccevs.org/static_html/protection-profile/428/-428-/index.html</url>
     

      <modified-sfrs>
        
        <!--
        <section title="Identification and Authentication (FIA)" id="mdm-m-fia">
          
          <f-component cc-id="fia_x509_ext.1" iteration="CERTVAL_SEL" id="mdm-fia-x509-ext-1-2" name=" X.509 Certificate Validation">
            <consistency-rationale>There is no modification to this SFR, but it is mandatory for a TOE that conforms to this PP-Module because
              it must always be claimed when an MDM includes an MDM Agent as part of the TOE.</consistency-rationale>
            <f-element id="mdm-fia-x509-ext-1-2e1">
              <title>
                <comment>This selection-based SFR becomes mandatory when used with this PP-Module because mutually-authenticated TLS or DTLS must be used to support communications between the MDM Agent and MDM Server.</comment>
              </title>
              <aactivity>
                <no-tests>There is no change to the Base-PP EAs for this SFR when this PP-Module is claimed.</no-tests>
              </aactivity>
            </f-element>
            <audit-event/>
          </f-component>
          
        </section>
      -->  
        <section title="Protection of the TSF (FPT)" id="mdm-mod-fpt">
          
          <base-sfr-spec id="mod-fpt-itt-1" iteration="INTER_XFER_AGENT" title="Internal TOE TSF Data Transfer (MDM Agent)" cc-id="fpt_itt.1">
            <consistency-rationale>There is no modification to this SFR, but it is mandatory for a TOE that conforms to this PP-Module because it must always be claimed when an MDM includes an MDM Agent as part of the TOE.</consistency-rationale>
            <description>This PP-Module requires that communications between the MDM Server and MDM Agent portions of the TOE are secured in the manner specified by FPT_ITT.1/INTER_XFER_AGENT in the MDM PP. This PP-Module does not require that this channel be established in a specific manner beyond this function using one of the methods specified in the MDM PP; a registration channel over an untrusted network, a registration channel over an environmentally protected network, or registration without the use of a registration channel is permitted. Depending on the method used, the appropriate MDM PP SFR claims must be made.</description>
            
          <set-status status="mandatory"/>
          </base-sfr-spec>
        </section>
        
        <section title="Trusted Path/Channels (FPT)" id="mdm-mod-ftp">
          
          <base-sfr-spec id="mod-ftp-itc-ext-1" title="Trusted Channel" cc-id="ftp_itc_ext.1">
            <consistency-rationale>This SFR is modified in a way that accommodates an MDM Agent, which is part of the TOE boundary
              when this PP-Module is claimed.</consistency-rationale>
            <description>This PP-Module requires the ST author to select that an MDM Agent is internal to the TOE because the TOE boundary includes both 
              an MDM Server and MDM Agent by definition when this PP-Module is claimed. As noted above, the fact that the TOE includes both MDM Server
              and MDM Agent components means that FPT_ITT.1/INTER_XFER_AGENT from the MDM PP must also be claimed, as this SFR defines the channel used for secure
              communications between these two components.</description>
            
            <replace>
              <xpath-specified xpath="*//cc:f-element[@id='fel-itc-ext']//cc:title">
                <title>
                  The TSF shall provide a communication channel between itself and [<h:i>an MDM Agent that is internal to the TOE</h:i>] that is logically distinct from other communication channels, as specified in [<h:i>FPT_ITT.1/INTER_XFER_AGENT</h:i>].
                </title>
              </xpath-specified>
            </replace>
          </base-sfr-spec>
        </section>
        
      </modified-sfrs>
      <additional-sfrs>
        
        <!-- Audit table for Additional SFRs -->
        <section id="sec-at-mdm-addnl" title="Auditable Events for MDM PP Additional SFRs">
          <audit-table id="at-mdm-addnl" table="tab-at-mdm-addnl" title="Auditable Events for MDM PP Additional SFRs"/>
        </section>
        
        <sec:mdm_mod_fcs title="Cryptographic Support (FCS)">
          <f-component cc-id="fcs_stg_ext.1" name="Cryptographic Key Storage" iteration="MDMKEYS">
            <!-- Removed notnew=y from f-component -->
            <consistency-rationale> The Base-PP requires the TOE to define a
              method of key storage. This PP-Module iterates it to specify the use
              of platform key storage for MDM Agents. </consistency-rationale>
            <f-element>
              <title>The <h:b>MDM Agent portion of the</h:b> TSF shall use [<h:i>platform-provided key storage</h:i>] for all persistent
                secret and private keys.</title>
              <note role="application"> This requirement ensures that persistent secrets
                (credentials, secret keys) and private keys are stored securely when not in use by
                the mobile platform.<h:br/><h:br/>
              </note>
              <aactivity>
                <TSS> 
                  <h:p>The evaluator shall verify that the TSS lists each persistent
                  secret (credential, secret key) and private key needed to meet the requirements in
                  the ST. For each of these items, the evaluator shall confirm that
                  the TSS lists for what purpose it is used, and, for each
                  platform listed as supported in the ST, how it is stored. The
                  evaluator shall verify that the MDM Agent calls a platform-provided API to store
                  persistent secrets and private keys.</h:p>
                </TSS>
                <Guidance>
                  <h:p>There are no guidance EAs for this component.</h:p>
                </Guidance>
                <Tests>
                  <h:p>There are no test EAs for this component.</h:p>
                </Tests>
              </aactivity>
            </f-element>
            <audit-event table="tab-at-mdm-addnl"/>
          </f-component>
        </sec:mdm_mod_fcs>

      </additional-sfrs>
      <con-toe> When this PP-Module is used to extend the MDM
        PP, the TOE type for the overall TOE is still mobile device management. The TOE boundary is
        simply extended to include the MDM Agents that reside on individual
        MDs and support the management functionality that the MDM
        Server component implements.</con-toe>
      <con-sec-prob/>
      <con-obj/>
      <con-op-en/>
      <con-mod ref="T.INSECURE_MDM_COMMUNICATIONS">This threat exploits network connectivity, consistent with T.NETWORK_EAVESDROP and T.NETWORK_ATTACK threats defined in the Base-PP.
      </con-mod>
      <con-mod ref="T.MISUSED_DEVICE">This threat exploits issues with configuration of the managed device, consistent with the T.MALICIOUS_APPS threat defined in the Base-PP.
      </con-mod>
      <con-mod ref="T.UNAUTHORIZED_POLICY_SOURCE">This threat exploits impersonation of a legitimate policy source, which is consistent with the T.NETWORK_ATTACK threat defined in the Base-PP.</con-mod>
      
      <con-mod ref="A.CONNECTIVITY">This assumption expects that networking services will be available for the TOE to use. 
        This is consistent with the Base-PP because the portion of the TOE defined by the Base-PP runs on a 
        GPOS or specialized network appliance. 
        The Base-PP does not make any assumptions about the environmental functionality that this PP-Module relies on, 
        so there is nothing in this PP-Module that would contradict it.</con-mod>
      <con-mod ref="A.PLATFORM">This assumption expects that the TOE’s underlying hardware platform is appropriately secure. 
        This is consistent with the Base-PP because the portion of the TOE defined by the Base-PP runs on a GPOS or 
        specialized network appliance. The Base-PP does not make any assumptions about the environmental functionality that this PP-Module relies on, 
        so there is nothing in this PP-Module that would contradict it.</con-mod>
      <con-mod ref="A.PROPER_ADMIN">	
        The Base-PP defines an A.PROPER_ADMIN assumption that is identical to the one defined by the PP-Module. 
        The PP-Module just extends it to the entire TOE boundary rather than just the MDM Server.</con-mod>
      <con-mod ref="A.PROPER_USER">	
        The Base-PP defines an A.PROPER_USER assumption that is identical to the one defined by the PP-Module. 
        The PP-Module just extends it to the entire TOE boundary rather than just the MDM Server.</con-mod>
      
      <con-mod ref="P.ACCOUNTABILITY">The Base-PP defines a P.ACCOUNTABILITY OSP that is identical to the one defined by the PP-Module. 
        The PP-Module just extends it to the entire TOE boundary rather than just the MDM Server.</con-mod>
      <con-mod ref="P.ADMIN">The Base-PP defines a P.ADMIN OSP that is identical to the one defined by the PP-Module. 
        The PP-Module just extends it to the entire TOE boundary rather than just the MDM Server.</con-mod>
      <con-mod ref="P.DEVICE_ENROLL">	
        The Base-PP defines a P.DEVICE_ENROLL OSP that is identical to the one defined by the PP-Module. 
        The PP-Module just extends it to the entire TOE boundary rather than just the MDM Server.</con-mod>
      <con-mod ref="P.NOTIFY">The Base-PP defines a P.NOTIFY OSP that is identical to the one defined by the PP-Module. 
        The PP-Module just extends it to the entire TOE boundary rather than just the MDM Server.</con-mod>
    
      <con-mod ref="OE.DATA_PROPER_ADMIN"> The MDM PP contains an objective named OE.PROPER_ADMIN with the same
        purpose. </con-mod>
      <con-mod ref="OE.DATA_PROPER_USER"> The MDM PP contains an objective named OE.PROPER_USER with the same
        purpose. </con-mod>
      <con-mod ref="OE.IT_ENTERPRISE"> The MDM PP contains this same objective with the same purpose. </con-mod>
      <con-mod ref="OE.DEVICE_PLATFORM">The MDM PP environmental security objectives only relate to the security of the platform on which the 
      MDM Server portion of the TOE is running. This objective extends the scope of the trusted platform to MDM Agent devices.</con-mod>
      <con-mod ref="OE.WIRELESS_NETWORK">The MDM PP contains this same objective with the same purpose.</con-mod>
      <con-mod ref="fau-alt-ext-2"> This SFR provides the alerts that are received by the 
        MDM Server as per FAU_ALT_EXT.1 in the Base-PP.</con-mod>
      <con-mod ref="fau-gen-1-agent"> This SFR requires the MDM Agent to generate audit data of its
        behavior. The mechanism by which it does this is not relevant to the MDM Server portion of
        the TOE as they reside on different platforms.</con-mod>
      <con-mod ref="fau-sel-1-agent"> The Base-PP includes FAU_SEL.1 as an optional SFR
        to limit the audit events that are generated by the TSF. This PP-Module
        adds another iteration that requires the MDM Agent to include this
        capability by default.</con-mod>
      <con-mod ref="fia-enr-ext-2"> This SFR provides information during MDM Agent enrollment that is
        required by the MDM Server to meet the FIA_ENR_EXT.1 requirement defined
        by the Base-PP.</con-mod>
      <con-mod ref="fmt-pol-ext-2"> The Base-PP includes an SFR (FMT_POL_EXT.1) that
        requires the MDM Server to provide digitally signed policies and policy
        updates to the MDM Agent. FMT_POL_EXT.2 completes this transaction by
        requiring the MDM Agent to accept only signed policies and policy
        updates.</con-mod>
      <con-mod ref="fmt-smf-ext-4"> This SFR requires the MDM Agent to interact
        with the underlying MD platform to enforce management functions that are
        configured by the MDM Server (FMT_SMF.1/SERVER_CONF_AGENT in the Base-PP).</con-mod>
      <con-mod ref="fmt-unr-ext-1"> This SFR requires the TSF to define its behavior upon
        unenrollment from management. Unenrollment from management is a management function that is
        specified in the Base-PP.</con-mod>
      <con-mod ref="fau-stg-ext-3"> This SFR defines the ability of the MDM Agent
        to store generated audit data in the audit storage provided by the MD. This does
        not impact the Base-PP since it resides on a different platform from the
          MDM Agent. </con-mod>
      <con-mod ref="fpt-net-ext-1"> This SFR defines the ability of the MDM Agent
        to maintain information about its last successful connection with the environmental 
          MDM Server (i.e., the last successful invocation of the trusted channel for
        that interface, as defined in FPT_ITT.1/INTER_XFER_AGENT of the Base-PP). It does not
        otherwise impact the Base-PP since it describes behavior that occurs local
        to the MDM Agent during a period where it is not interacting with the
          MDM Server. </con-mod>
    </base-pp>
    <base-pp id="bpp-gpos" name="General Purpose Operating System" product="Operating System"
      short="GPOS" version="5.0">
      <git>
        <url>https://github.com/commoncriteria/operatingsystem </url> 
        <branch>release-5.0</branch>
      </git>
      <url>https://www.niap-ccevs.org/static_html/protection-profile/469/OS%204.3%20PP/index.html</url>
   
      <modified-sfrs>
        
        <section title="Cryptographic Support (FCS)" id="gpos-mod-fcs">
          
          <base-sfr-spec id="mod-fcs-sto-ext-1" title="Storage of Sensitive Data" cc-id="fcs_sto_ext.1">
            <consistency-rationale>The PP-Module does not change this SFR; it only notes that the concept of "sensitive data" may be expanded
              to include any sensitive data created or used by the portion of the TOE described by the PP-Module.</consistency-rationale>
            <description>
              <h:p>
              There is no change to this SFR from the Base-PP beyond ensuring that it also applies to the MDM Agent portion of the TOE.
              </h:p>
              The text of the requirement is replaced with:<h:br/><h:br/>
              
              The OS shall implement functionality to encrypt sensitive data <h:b>including any data used for MDM Agent functionality</h:b> stored in non-volatile storage and provide interfaces to applications to invoke this functionality.
              
            </description>
            
            <replace>
              <xpath-specified xpath="*//cc:f-element[@id='fel-store-sdata']//cc:title">
                <title>
                  The OS shall implement functionality to encrypt sensitive data <h:b>including any data used for MDM Agent functionality</h:b> stored in non-volatile storage and provide interfaces to applications to invoke this functionality.
                </title>
              </xpath-specified>
            </replace>
          </base-sfr-spec>
        </section>
        <section title="Security Management (FMT)" id="gpos-mod-fmt">
          
          <base-sfr-spec id="mod-fmt-smf-ext-1" title="Specification of Management Functions" cc-id="fmt_smf_ext.1">
            <consistency-rationale>The PP-Module changes this SFR to make additional management
              functions necessary when an MDM Agent is based off of the GPOS PP. This is done to match the management functions required in the MDM PP.</consistency-rationale>
            <description>
            <h:p>
              This SFR is not reproduced in its entirety for size purposes. Functions 1 - 21 and function 36 are assigned mandatory in the "Administrator" column. An additional column of "Admin Only (When Enrolled in Management)" is added to the table and functions 1, 2, and 8 are assigned mandatory in this column.
              </h:p>
              <h:table border="1" style="width:100%">
              <h:tr>
                  <h:td><h:b>#</h:b></h:td>
                  <h:td><h:b>Management Function</h:b></h:td>
                  <h:td><h:b>User</h:b></h:td>
                  <h:td><h:b>Administrator</h:b></h:td>
                  <h:td><h:b>Admin Only (When Enrolled in Management)</h:b></h:td>
                </h:tr>
              <h:tr>
                <h:td>1</h:td>
                <h:td>configure password policy:
                                <h:ol type="a">
                                <h:li>minimum password length</h:li>
                                <h:li>minimum password complexity</h:li>
                                <h:li>maximum password lifetime</h:li>
                              </h:ol>
                </h:td>
                <h:td>O</h:td>
                <h:td>M</h:td>
                <h:td>M</h:td>
              </h:tr>
              <h:tr>
                <h:td>2</h:td>
                <h:td> configure session locking policy: <h:ol type="a">
                      <h:li>screen-lock enabled/disabled</h:li>
                      <h:li>screen lock timeout </h:li>
                      <h:li>number of authentication failures</h:li>
                    </h:ol>
                </h:td>
                 <h:td>O</h:td>
                 <h:td>M</h:td>
                 <h:td>M</h:td>
              </h:tr>   
              <h:tr>
                <h:td>3</h:td>
                  <h:td>enable/disable the VPN protection: <h:ol type="a">
                    <h:li>across device</h:li>
                    </h:ol>
					          [<h:b>selection</h:b>:
                    <h:ol type="a" start="2">
                      <h:li>on a per-app basis</h:li>
                      <h:li>on a per-group of applications processes basis</h:li>
                      <h:li>no other method</h:li>]</h:ol>
        </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>4</h:td>
        <h:td>enable/disable [<h:b>assignment</h:b>: list of all radios]</h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>5</h:td>
        <h:td>
                     enable/disable
                      [<h:b>assignment</h:b>: list of audio or visual collection devices]: <h:ol type="a">
                      <h:li>across device</h:li></h:ol>
                    [<h:b>selection</h:b>: <h:ol type="a" start="2">
                        <h:li>on a per-app basis</h:li>
                        <h:li>on a per-group of applications processes basis</h:li>
                        <h:li>no other method</h:li>
                    </h:ol> ]
                  </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>6</h:td>
        <h:td>transition to the locked state</h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>7</h:td>
        <h:td> TSF wipe of protected data </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>8</h:td>
        <h:td> configure application installation policy by [<h:b>selection</h:b>: <h:ol type="a">
            <h:li>restricting the sources of applications</h:li>
            <h:li>specifying a set of allowed applications based on [<h:b>assignment</h:b>: application characteristics ] (an application allowlist)</h:li>
            <h:li>denying installation of applications</h:li>

        </h:ol>
        ]
        </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>M</h:td>
    </h:tr>
    <h:tr>
        <h:td>9</h:td>
        <h:td>import keys/secrets into the secure key storage </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>10</h:td>
        <h:td>destroy imported keys/secrets and [<h:b>selection</h:b>: no other keys/secrets, [<h:b>assignment</h:b>: list of other categories of keys/secrets]] in the secure key storage</h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>11</h:td>
        <h:td>import X.509v3 certificates into the Trust Anchor Database </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>12</h:td>
        <h:td>remove imported X.509v3 certificates and [<h:b>selection</h:b>: no other X.509v3 certificates, [<h:b>assignment</h:b>: list of other categories of X.509v3 certificates]] in the Trust Anchor Database </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>13</h:td>
        <h:td>enroll the TOE in management </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>14</h:td>
        <h:td>remove applications </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>15</h:td>
        <h:td>update system software </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>16</h:td>
        <h:td>install applications </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>17</h:td>
        <h:td>remove Enterprise applications </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>18</h:td>
        <h:td>enable/disable display notification in the locked state of: [<h:b>selection</h:b>: <h:ol type="a">
                    <h:li>email notifications</h:li>
                    <h:li>calendar appointments</h:li>
                    <h:li>contact associated with phone call notification</h:li>
                    <h:li>text message notification</h:li>
                    <h:li>other application-based notifications</h:li>
                    <h:li>all notifications</h:li></h:ol>]
                  </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>19</h:td>
        <h:td> enable data-at rest protection</h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>20</h:td>
        <h:td>enable removable media's data-at-rest protection </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>21</h:td>
        <h:td>enable/disable location services: <h:ol type="a">
                      <h:li>across device</h:li></h:ol>
                    [<h:b>selection</h:b>: b. on a per-app basis 
                        c. on a per-group of applications processes basis 
                        d. no other method ]
                  </h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    <h:tr>
        <h:td>36</h:td>
        <h:td>configure the access banner</h:td>
        <h:td>O</h:td>
        <h:td>M</h:td>
        <h:td>O</h:td>
    </h:tr>
    
              </h:table>
                       
            </description>
            
            <replace>
              <xpath-specified xpath="*//cc:f-element[@id='fel-store-sdata']//cc:title">
                <title>The TSF shall be capable of performing the following management functions: <h:br/><h:br/>
              <h:b><ctr id="fmt_smf" ctr-type="Table">: Management Functions</ctr></h:b><h:br/><h:br/> 
              Status Markers:<h:br/> M - Mandatory<h:br/> O - Optional/Objective<h:br/>
              <!-- NOTE: management-function uses ctr variables crt-type=functions in the MOOO table, so that they do not 
		   have to be renumbered when one is added or removed. However app notes and AAs need to be in the same order as the functions.
		   The list of IDs for each function is at the end of the xml.-->
              <management-function-set default="O">
                <manager cid="I">Impl.</manager>
                <manager cid="U">User Only</manager>
                <manager cid="A">Admin</manager>
                <manager cid="AO">Admin Only</manager>
                <management-function id="mf-pwd">
                  <text>
                    <!-- <ctr id="pwd" pre="" ctr-type="function">.</ctr>--> configure password policy:
                      <h:ul>
                      <h:li>Minimum password length</h:li>
                      <h:li>Minimum password complexity</h:li>
                      <h:li>Maximum password lifetime</h:li>
                    </h:ul>
                  </text>
                  <M ref="I"/> <NA ref="U"/><M ref="A"/><M ref="AO"/>
		  <aactivity>
		    <TSS>The evaluator shall verify
                  the TSS defines the allowable policy options: the range of values for both
                  password length and lifetime, and a description of complexity to include character
                  set and complexity policies (e.g., configuration and enforcement of number of
                  uppercase, lowercase, and special characters per password).</TSS>
		  <Tests>
The evaluator shall exercise the TSF configuration as the administrator and
                    perform positive and negative tests, with at least two values set for each
                    variable setting, for each of the following: <h:br/>
                    <h:ul>
                      <h:li>Minimum password length</h:li>
                      <h:li>Minimum password complexity</h:li>
                      <h:li>Maximum password lifetime</h:li>
                    </h:ul>
		    </Tests>
		  </aactivity>

                </management-function>
                <management-function id="mf-screenlock">
                  <text>
                    <!-- <ctr id="screenlock" pre="" ctr-type="function">.</ctr>--> configure session
                    locking policy: <h:ul>
                      <h:li>Screen-lock enabled/disabled</h:li>
                      <h:li>Screen lock timeout </h:li>
                      <h:li>Number of authentication failures</h:li>
                    </h:ul>
                  </text>
                  <M ref="I"/><NA ref="U"/><M ref="A"/><M ref="AO"/>
		  <aactivity>
		    <TSS>The evaluator shall
                    verify the TSS defines the range of values for both timeout period and number of
                    authentication failures for all supported authentication mechanisms.</TSS>
		    <Tests> The evaluator shall exercise the TSF configuration as the administrator.
                    The evaluator shall perform positive and negative tests, with at least two
                    values set for each variable setting, for each of the following: <h:br/>
                    <h:ul>
                      <h:li>Screen-lock enabled/disabled</h:li>
                      <h:li>Screen lock timeout</h:li>
                      <h:li>Number of authentication failures (may be combined with test for
                        FIA_AFL_EXT.1)</h:li>
                    </h:ul>
		    </Tests>
		  </aactivity>
                </management-function>
                <management-function id="mf-vpn">
                  <text>
                    <!-- <ctr id="vpn" pre="" ctr-type="function">.</ctr>--> enable/disable the VPN
                    protection: <h:ul>
                      <h:li>Across device</h:li></h:ul>
                    <h:div class="indent">
					<selectables linebreak="yes">
                        <selectable id="s-vpn-per-app">on a per-app basis</selectable>
                        <selectable id="s-vpn-per-appgroup">on a per-group of applications processes basis</selectable>
                        <selectable exclusive="yes">no other method</selectable>
                      </selectables></h:div>
                  </text>
                  <M ref="I"/>
                  <app-note><also ref-id="mf-audioVisual"/><also ref-id="mf-location"/>
		  Functions <_/> must be implemented on a device-wide basis but may also be
		  implemented on a per-app basis or on a per-group of applications basis in which the
		  configuration includes the list of applications or groups of applications to which the
		  enable/disable applies.</app-note>
		  <app-note>
		  Function <_/> addresses
		  enabling and disabling the IPsec VPN only. The configuration of the VPN Client itself
		  (with information such as VPN Gateway, certificates, and algorithms) is addressed by
		  the <xref to="mod-vpnclient"/>. The administrator options should only be listed if the
		  administrator can remotely enable/disable the VPN connection.
		  <h:p>
		  Function <xref to="mf-vpn"/> optionally allows the VPN to be configured per-app or
		  per-groups of apps. If this configuration is selected, it does not void FDP_IFC_EXT.1.
		  Instead FDP_IFC_EXT.1 is applied to the application or group of applications the VPN
		  is applied to. In other words, all traffic destined for the VPN-enabled application or
		  group of applications, must travel through the VPN, but traffic not destined for that
		  application or group of applications can travel outside the VPN. When the VPN is
		  configured across the device FDP_IFC_EXT.1 applies to all traffic and the VPN must not
		  split tunnel.
		  </h:p>
		  </app-note>
		  <aactivity>
        <Tests>
		    The evaluator shall perform the following tests: 
          <testlist>
                      <test>The evaluator shall exercise the TSF configuration to enable the VPN
                        protection. These configuration actions must be used for the testing of the
                        FDP_IFC_EXT.1.1 requirement. </test>
                      <test>[conditional] If "<xref to="s-vpn-per-app"/>" is selected, the evaluator shall
                        create two applications and enable one to use the VPN and the other to not
                        use the VPN. The evaluator shall exercise each application (attempting to
                        access network resources; for example, by browsing different websites)
                        individually while capturing packets from the TOE. The evaluator shall
                        verify from the packet capture that the traffic from the VPN-enabled
                        application is encapsulated in IPsec and that the traffic from the
                        VPN-disabled application is not encapsulated in IPsec. </test>
                      <test>[conditional] If "<xref to="s-vpn-per-appgroup"/>" is selected, the
                        evaluator shall create two applications and the applications shall be placed
                        into different groups. Enable one application group to use the VPN and the
                        other to not use the VPN. The evaluator shall exercise each application
                        (attempting to access network resources; for example, by browsing different
                        websites) individually while capturing packets from the TOE. The evaluator
                        shall verify from the packet capture that the traffic from the application
                        in the VPN-enabled group is encapsulated in IPsec and that the traffic from
                        the application in the VPN-disabled group is not encapsulated in IPsec.
                      </test>
            </testlist>
          </Tests>
        </aactivity>
                </management-function>
                <management-function id="mf-radios">
                  <text>
                    <!-- <ctr id="radios" pre="" ctr-type="function">.</ctr>--> enable/disable
                      <assignable id="a-mf-radios">list of all radios</assignable></text>
                      <M ref="I"/>
		      <app-note>
			The assignment in function <_/>
              consists of all radios present on the TSF, such as Wi-Fi, cellular, NFC,
              Bluetooth BR/EDR, and Bluetooth LE, which can be enabled and disabled.
	      In the future,
              if both Bluetooth BR/EDR and Bluetooth LE are supported, they will be required to be
              enabled and disabled separately. Disablement of the cellular radio does not imply that
              the radio may not be enabled in order to place emergency phone calls; however, it is
              not expected that a device in "airplane mode", where all radios are disabled, will
              automatically (without authorization) turn on the cellular radio to place emergency
              calls.</app-note>
		      <aactivity><TSS>
			The evaluator shall
                  verify that the TSS includes a description of each radio and an indication of if
                  the radio can be enabled/disabled along with what role can do so. In addition the
                  evaluator shall verify that the frequency ranges at which each radio operates is
                  included in the TSS. The evaluator shall verify that the TSS includes at what point 
                  in the boot sequence the radios are powered on and indicates if the radios are used 
                  as part of the initialization of the device.
		  </TSS><Guidance>
                  The evaluator shall confirm that the AGD guidance describes
                  how to perform the enable/disable function for each radio.<h:br/><h:br/>
		</Guidance>
		<Tests>
		  The
                  evaluator shall ensure that minimal signal leakage enters the RF shielded
                  enclosure (i.e. Faraday bag, Faraday box, RF shielded room) by performing the
                  following steps:<h:br/><h:br/> Step 1: Place the antenna of the spectrum
                  analyzer inside the RF shielded enclosure.<h:br/><h:br/> Step 2: Enable "Max
                  Hold" on the spectrum analyzer and perform a spectrum sweep of the frequency range
                  between 300 MHz – 6000 MHz, in I kHz steps (this range should encompass 802.11,
                  802.15, GSM, UMTS, and LTE). This range will not address NFC 13.56.MHz, another
                  test should be set up with similar constraints to address NFC.<h:br/><h:br/>
                  If power above -90 dBm is observed, the Faraday box has too great of signal
                  leakage and shall not be used to complete the test for
		  Function <xref to="mf-radios"/>.

		  The evaluator shall exercise the TSF configuration as the administrator and,
                    if not restricted to the administrator, the user, to enable and disable the
                    state of each radio (e.g. Wi-Fi, cellular, NFC, Bluetooth). Additionally,
                    the evaluator shall repeat the steps below, booting into any auxiliary boot mode
                    supported by the device. For each radio, the evaluator shall:<h:br/><h:br/>
                    Step 1: Place the antenna of the spectrum analyzer inside the RF shielded
                    enclosure. Configure the spectrum analyzer to sweep desired frequency range for
                    the radio to be tested (based on range provided in the TSS)). The ambient noise
                    floor shall be set to -110 dBm. Place the TOE into the RF shielded enclosure to
                    isolate them from all other RF traffic. <h:br/><h:br/> Step 2: The evaluator
                    shall create a baseline of the expected behavior of RF signals. The evaluator
                    shall power on the device, ensure the radio in question is enabled, power off
                    the device, enable "Max Hold" on the spectrum analyzer and power on the device.
                    The evaluator shall wait 2 minutes at each Authentication Factor interface prior
                    to entering the necessary password to complete the boot process, waiting 5
                    minutes after the device is fully booted. The evaluator shall observe that RF
                    spikes are present at the expected uplink channel frequency. The evaluator shall
                    clear the "Max Hold" on the spectrum analyzer. <h:br/><h:br/> Step 3: The
                    evaluator shall verify the absence of RF activity for the uplink channel when
                    the radio in question is disabled. The evaluator shall complete the following
                    test five times. The evaluator shall power on the device, ensure the radio in
                    question is disabled, power off the device, enable "Max Hold" on the spectrum
                    analyzer and power on the device. The evaluator shall wait 2 minutes at each
                    Authentication Factor interface prior to entering the necessary password to
                    complete the boot process, waiting 5 minutes after the device is fully booted.
                    The evaluator shall clear the "Max Hold" on the spectrum analyzer. If the radios 
                    are used for device initialization, then a spike of RF activity for the uplink channel
                    can be observed initially at device boot. However, if a spike of
                    RF activity for the uplink channel of the specific radio frequency band is
                    observed after the device is fully booted or at an Authentication Factor interface 
                    it is deemed that the radio is enabled. 
		</Tests></aactivity>
                </management-function>
                <management-function id="mf-audioVisual">
                  <text>
                    <!-- <ctr id="audioVisual" pre="" ctr-type="function">.</ctr>--> enable/disable
                     <assignable id="a-audiovisual-devs">list of audio or visual collection devices</assignable>: <h:ul>
                      <h:li>Across device</h:li></h:ul>
                    <h:div class="indent"><selectables linebreak="yes">
                        <selectable id="s-audiovisual-per-app">on a per-app basis</selectable>
                        <selectable id="s-audiovisual-per-appgroup">on a per-group of applications processes basis</selectable>
                        <selectable exclusive="yes">no other method</selectable>
                      </selectables></h:div>
                  </text>
                  <M ref="I"/>
		  <app-note>The assignment in function <_/>
              consists of at least one audio or visual device, such as camera and microphone,
              which can be enabled and disabled by either the user or administrator. Disablement of
              the microphone does not imply that the microphone may not be enabled in order to place
              emergency phone calls. If certain devices are able to be restricted to the enterprise
              (either device-wide, per-app or per-group of applications) and others are able to be
              restricted to users, then this function should be iterated in the table with the
              appropriate table entries.
	      <h:p>
		Regarding functions <xref to="mf-radios"/> and <xref to="mf-audioVisual"/>,
		disablement of a particular
              radio or audio/visual device must be effective as soon as the TOE has power.
              Disablement must also apply when the TOE is booted into auxiliary boot modes, for
              example, associated with updates or backup. If the TOE supports states in which
              security management policy is inaccessible, for example, due to data-at-rest
              protection, it is acceptable to meet this requirement by ensuring that these devices
              are disabled by default while in these states. That these devices are disabled during
              auxiliary boot modes does not imply that the device (particularly the cellular radio)
              may not be enabled in order to perform emergency phone calls. 
	      </h:p>
		  </app-note>
		  <aactivity><TSS>
		     The evaluator
                  shall verify that the TSS includes a description of each collection device and an
                  indication of if it can be enabled/disabled along with what role can do so. The
                  evaluator shall confirm that the AGD guidance describes how to perform the
                  enable/disable function.
		  </TSS>
        <Tests>The evaluator shall perform the following tests:
          <testlist>
                      <test>The evaluator shall exercise the TSF configuration as the
                        administrator and, if not restricted to the administrator, the user, to
                        enable and disable the state of each audio or visual collection devices
                        (e.g. camera, microphone) listed by the ST author. For each collection
                        device, the evaluator shall disable the device and then attempt to use its
                        functionality. The evaluator shall reboot the TOE and verify that disabled
                        collection devices may not be used during or early in the boot process.
                        Additionally, the evaluator shall boot the device into each available
                        auxiliary boot mode and verify that the collection device cannot be used. </test>
                      <test>[conditional] If "<xref to="s-audiovisual-per-app"/>" is selected, the evaluator shall
                        create two applications and enable one to use access the A/V device and the
                        other to not access the A/V device. The evaluator shall exercise each
                        application attempting to access the A/V device individually. The evaluator
                        shall verify that the enabled application is able to access the A/V device
                        and the disabled application is not able to access the A/V device. </test>
                      <test>[conditional] If "<xref to="s-audiovisual-per-appgroup"/>" is selected, the
                        evaluator shall create two applications and the applications shall be placed
                        into different groups. Enable one group to access the A/V device and the
                        other to not access the A/V device. The evaluator shall exercise each
                        application attempting to access the A/V device individually. The evaluator
                        shall verify that the application in the enabled group is able to access the
                        A/V device and the application in the disabled group is not able to access
                        the A/V device. </test>
            </testlist>
		      </Tests>
		</aactivity>
                </management-function>
                <management-function id="mf-lockState">
                  <text>
                    <!-- 6. -->
                    <!-- <ctr id="lockState" pre="" ctr-type="function">.</ctr>--> transition to the locked
                    state </text>
                    <M ref="I"/><NA ref="U"/><M ref="A"/><NA ref="AO"/>
		    <aactivity><Tests>
		      The evaluator shall use the test environment to instruct the TSF, both as a
                      user and as the administrator, to command the device to transition to a locked
                      state, and verify that the device transitions to the locked state upon
                      command.
		    </Tests></aactivity>
                </management-function>
                <management-function id="mf-wipe">
                  <text>
                    <!-- 7. -->
                    <!-- <ctr id="wipe" pre="" ctr-type="function">.</ctr>--> TSF wipe of protected data </text>
                  <M ref="I"/>
                  <NA ref="U"/>
                  <M ref="A"/>
                  <NA ref="AO"/>
		  <app-note>
		    Wipe  of the TSF (function <xref to="mf-wipe"/>) is performed according to
		    FCS_CKM_EXT.5.
		    Protected data is all non-TSF data, including all user or enterprise data. Some or all
		  of this data may be considered sensitive data as well.</app-note>
      <aactivity>
      <Tests>The evaluator shall use the test environment to instruct the TSF, both as a user and as the administrator, to command the device to perform a wipe of protected data. 
      The evaluator must ensure that this management setup is used when conducting the Evaluation Activities in FCS_CKM_EXT.5.</Tests>
      </aactivity>
                </management-function>
                <management-function id="mf-appInstallRules">
                  <text>
                    <!--8. -->
                    <!-- <ctr id="appInstallRules" pre="" ctr-type="function">.</ctr>--> configure
                    application installation policy by <h:div class="indent"><selectables linebreak="yes">
                        <selectable id="mf-appInstallRules-restrict">restricting the sources of applications</selectable>
                        <selectable id="mf-appInstallRules-specify">specifying a set of allowed applications based on
                            <assignable>application characteristics</assignable> (an <snip>application allowlist</snip>)</selectable>
                        <selectable id="mf-appInstallRules-deny">denying installation of applications</selectable>
                      </selectables></h:div>
                  </text>
                  <M ref="I"/><NA ref="U"/><M ref="A"/><M ref="AO"/>
		  <app-note>
		    The
		    selection in function <xref to="mf-appInstallRules"/> allows the ST author to
		    select which mechanisms are available to the administrator through the MDM Agent to
		    restrict the applications which the user may install. The ST author must state if
		    application allowlist is applied device-wide or if it can be specified to apply to
		    either the Enterprise or Personal applications. <h:ul>
                    <h:li>If the administrator can restrict the sources from which applications can be
                    installed, the ST author selects "<xref to="mf-appInstallRules-restrict"/>". </h:li>
                    <h:li>If the administrator can specify a allowlist of allowed applications, the ST
                    author selects "<xref to="mf-appInstallRules-specify"/>". The ST author should list any application characteristics
                    (e.g. name, version, or developer) based on which the allowlist can be
                    formed.</h:li>
                    <h:li>If the administrator can prevent the user from installing additional
                    applications, the ST author selects "<xref to="mf-appInstallRules-deny"/>". </h:li>
		  </h:ul>
		  </app-note>
		  <aactivity><TSS>
		     The evaluator
                  shall verify the TSS describes the allowable application installation policy
                  options based on the selection included in the ST.
		  If the <xref to="mf-appInstallRules-specify"/> is selected,
		  the evaluator shall verify that the TSS includes a description of each
                  application characteristic upon which the allowlist may be based.
		</TSS>
		<Tests> The evaluator shall exercise the TSF configuration as the administrator to
                    restrict particular applications, sources of applications, or application
                    installation according to the AGD guidance. The evaluator shall attempt to
                    install unauthorized applications and ensure that this is not possible. The
                    evaluator shall, in conjunction, perform the following specific tests: 
                    <testlist>
                      <test>[conditional] The evaluator shall attempt to connect to an
                        unauthorized repository in order to install applications. </test>
                      <test>[conditional] The evaluator shall attempt to install two applications
                        (one allowlisted, and one not) from a known allowed repository and verify
                        that the application not on the allowlist is rejected. The evaluator shall
                        also attempt to side-load executables or installation packages via USB
                        connections to determine that the white list is still adhered to
                      </test>
                      </testlist>
		</Tests>
		  </aactivity>
                </management-function>
                <management-function id="mf-keyStorage">
                  <text>
                    <!-- 9. -->
                    <!-- <ctr id="keyStorage" pre="" ctr-type="function">.</ctr>--> import keys or secrets into
                    the secure key storage </text>
                    <M ref="I"/><NA ref="AO"/>
		    <aactivity><also ref-id="mf-keyWipe"/>
		    <TSS>The evaluator shall verify that the TSS
                  describes each category of keys or secrets that can be imported into the TSF’s secure
                    key storage.</TSS>
		    <Tests>
		      The test of these functions is performed in association with FCS_STG_EXT.1.
		    </Tests>
		    </aactivity>
                </management-function>
                <management-function id="mf-keyWipe">
                  <text>
                    <!-- 10. -->
                    <!-- <ctr id="keyWipe" pre="" ctr-type="function">.</ctr>--> destroy imported
                    keys or secrets and <selectables>
                      <selectable exclusive="yes">no other keys or secrets</selectable>
                      <selectable><assignable>list of other categories of
                        keys or secrets</assignable></selectable>
                    </selectables> in the secure key storage </text>
                  <M ref="I"/><NA ref="AO"/>
                </management-function>
                <management-function id="mf-certImport">
                  <text>
                    <!-- 11. -->
                    <!-- <ctr id="certImport" pre="" ctr-type="function">.</ctr>--> import X.509v3
                    certificates into the Trust Anchor Database </text>
                    <M ref="I"/><NA ref="U"/><M ref="A"/>
		    <aactivity>
		      <Guidance>The evaluator shall
                  review the AGD guidance to determine that it describes the steps needed to import,
                  modify, or remove certificates in the Trust Anchor database, and that the users
                  that have authority to import those certificates (e.g., only administrator, or
                  both administrators and users) are identified.
		      </Guidance>
		      <Tests>
			The evaluator shall import certificates according to the AGD guidance as the
			user or as the administrator, as determined by the administrative guidance.
			The evaluator shall verify that no errors occur during import. The evaluator
			should perform an action requiring use of the X.509v3 certificate to provide
			assurance that installation was completed properly.
		      </Tests>
		    </aactivity>
                </management-function>
                <management-function id="mf-certWipe">
                  <text>
                    <!-- 12. -->
                    <!-- <ctr id="certWipe" pre="" ctr-type="function">.</ctr>--> remove imported X.509v3
                    certificates and <selectables>
                      <selectable exclusive="yes">no other X.509v3 certificates</selectable>
                      <selectable><assignable>list of other categories of X.509v3
                          certificates</assignable></selectable>
                    </selectables> in the Trust Anchor Database </text>
                    <M ref="I"/><NA ref="AO"/>
		    <app-note>
		      In the future, function <xref to="mf-certWipe"/> may require
              destruction or disabling of any default trusted CA certificates, excepting those CA
              certificates necessary for continued operation of the TSF, such as the developer’s
              certificate. At this time, the ST author must indicate in the assignment whether
              pre-installed or any other category of X.509v3 certificates may be removed from the
              Trust Anchor Database.
		    </app-note>
		    <aactivity>
		      <TSS>
			The evaluator shall
			verify that the TSS describes each additional category of X.509 certificates and
			their use within the TSF.
		      </TSS>
		      <Tests>
			The evaluator shall remove an administrator-imported certificate and any
                    other categories of certificates included in the assignment of function <xref
                      to="mf-appRemove"/> from the Trust Anchor Database according to the AGD
                    guidance as the user and as the administrator.
		      </Tests>
		    </aactivity>
		    
                </management-function>
                <management-function id="mf-enroll">
                  <text>
                    <!-- 13. -->
                    <!-- <ctr id="enroll" pre="" ctr-type="function">.</ctr>--> enroll the TOE in management </text>
                    <M ref="I"/><O ref="U"/><O ref="A"/><O ref="AO"/>
		    <app-note>
		      For function <xref to="mf-enroll"/>, the
		      enrollment function may be installing an MDM agent and includes the policies to be
		      applied to the device. It is acceptable for the user approval notice to require the
		      user to intentionally opt to view the policies (for example, by "tapping" on a "View"
		      icon) rather than listing the policies in full in the notice.
		    </app-note>
		    <aactivity>
		      <TSS>The evaluator shall
                  examine the TSS to ensure that it contains a description of each management
                  function that will be enforced by the enterprise once the device is enrolled. The
                  evaluator shall examine the AGD guidance to determine that this same information
                  is present.
		      </TSS>
		      <Tests>
		      The evaluator shall verify that user approval is required to enroll the
                      device into management.
		      </Tests>
		    </aactivity>
                </management-function>
                <management-function id="mf-appRemove">
                  <text>
                    <!-- 14. -->
                    <!-- <ctr id="appRemove" pre="" ctr-type="function">.</ctr>--> remove applications </text>
                    <M ref="I"/><NA ref="U"/><M ref="A"/>
		    <aactivity><TSS>
		       The evaluator shall
                  verify that the TSS includes an indication of what applications (e.g.,
                  user-installed applications, Administrator-installed applications, or Enterprise
                  applications) can be removed along with what role can do so. The evaluator shall
                  examine the AGD guidance to determine that it details, for each type of
                  application that can be removed, the procedures necessary to remove those
                  applications and their associated data. For the purposes of this Evaluation
                  Activity, "associated data" refers to data that are created by the app during its
                  operation that do not exist independent of the app's existence, for instance,
                  configuration data, or e-mail information that’s part of an e-mail client. It does
                  not, on the other hand, refer to data such as word processing documents (for a
                  word processing app) or photos (for a photo or camera app).
		  </TSS><Tests>
		  The evaluator shall attempt to remove applications according to the AGD
                    guidance and verify that the TOE no longer permits users to access those
                    applications or their associated data.</Tests></aactivity>
                </management-function>
                <management-function id="mf-update">
                  <text>
                    <!-- 15 -->
                    <!-- <ctr id="update" pre="" ctr-type="function">.</ctr>--> update system software </text>
                    <M ref="I"/><NA ref="U"/><M ref="A"/>
		    <app-note>
		      For function <xref to="mf-update"/>, the administrator capability to update the system
		      software may be limited to causing a prompt to the user to update rather than the
		      ability to initiate the update itself. As the administrator is likely to be acting
		      remotely, he/she would be unaware of inopportune situations, such as low power, which
		      may cause the update to fail and the device to become inoperable. The user can refuse
		      to accept the update in such situations. It is expected that system architects will be
		      cognizant of this limitation and will enforce network access controls in order to
		      enforce enterprise-critical updates.
		    </app-note>
		    <aactivity><Tests>The evaluator shall attempt to update the TSF system software following the
                    procedures in the AGD guidance and verify that updates correctly install and
                    that the version numbers of the system software increase.
		    </Tests></aactivity>
                </management-function>
                <management-function id="mf-appInstall">
                  <text>
                    <!-- 16. -->
                    <!-- <ctr id="appInstall" pre="" ctr-type="function">.</ctr>--> install applications </text>
                    <M ref="I"/><NA ref="U"/><M ref="A"/>
		    <app-note>
		      Function <xref
                to="mf-appInstall"/> addresses both installation and update. This protection profile
              does not distinguish between installation and update of applications because mobile
              devices typically completely overwrite the previous installation with a new
              installation during an application update.
		    </app-note>
                    <aactivity><Tests>The evaluator shall attempt to install an application following the
                    procedures in the AGD guidance and verify that the application is installed and
                    available on the TOE.</Tests></aactivity>
                </management-function>
                <management-function id="mf-entAppRemove">
                  <text>
                    <!-- 17. -->
                    <!-- <ctr id="entAppRemove" pre="" ctr-type="function">.</ctr>--> remove Enterprise
                  applications </text>
		  <M ref="I"/><NA ref="U"/><M ref="A"/><NA ref="AO"/>
		  <app-note>
		    For function <xref
                to="mf-entAppRemove"/>, "Enterprise applications" are those applications that belong
              to the Enterprise application group. Applications installed by the enterprise
              administrator (including automatic installation by the administrator after being
              requested by the user from a catalog of enterprise applications) are by default placed
              in the Enterprise application group unless an exception has been made in function
              <xref to="mf-appGroups"/> of FMT_SMF_EXT.1.1.
		  </app-note>
		  <aactivity><Tests>
		  The evaluator shall attempt to remove any Enterprise applications from the
                    device by following the administrator guidance. The evaluator shall verify that
                    the TOE no longer permits users to access those applications or their associated
                    data.</Tests></aactivity>
                </management-function>
                <management-function id="mf-notifications">
                  <text>
                    <!-- 18. -->
                    <!-- <ctr id="notifications" pre="" ctr-type="function">.</ctr>--> enable/disable
                    display notification in the locked state of: <selectables linebreak="yes">
                      <selectable>email notifications</selectable>
                      <selectable>calendar appointments</selectable>
                      <selectable>contact associated with phone call notification</selectable>
                      <selectable>text message notification</selectable>
                      <selectable><assignable>other application-based notifications</assignable></selectable>
                      <selectable>all notifications</selectable>
                    </selectables>
                  </text>
                  <M ref="I"/>
		  <app-note>
		    If the display
              of notifications in the locked state is supported, the configuration of these
              notifications (function <xref to="mf-notifications"/>) must be included in the
              selection.
		  </app-note>
		  <aactivity><Guidance>The evaluator
                  shall examine the AGD Guidance to determine that it specifies, for at least each
                  category of information selected for Function <xref to="mf-notifications"/>,
                  how to enable and disable display information for that type of information in the
                  locked state.
		</Guidance>
		<Tests>For each category of information listed in the AGD guidance, the evaluator
                    shall verify that when that TSF is configured to limit the information according
                to the AGD, the information is no longer displayed in the locked state.</Tests>
		</aactivity>
                </management-function>
                <management-function id="mf-dar">
                  <text>
                    <!-- 20. -->
                    <!-- <ctr id="dar" pre="" ctr-type="function">.</ctr>--> enable data-at rest protection </text>
                    <M ref="I"/>
		    <app-note>
		      Function <xref to="mf-dar"/> must be included in the
		      selection if data-at-rest protection is not natively enabled.
		    </app-note>
		    <aactivity><Tests>
		      The evaluator shall exercise the TSF configuration as the administrator and,
                    if not restricted to the administrator, the user, to enable system-wide
                    data-at-rest protection according to the AGD guidance. The evaluator shall
                    ensure that all Evaluation Activities for DAR (FDP_DAR) are conducted with the
                    device in this configuration.
		    </Tests></aactivity>
                </management-function>
		
                <management-function id="mf-rmediaDar">
                  <text>
                    <!-- 21. -->
                    <!-- <ctr id="rmediaDar" pre="" ctr-type="function">.</ctr>--> enable removable media’s
                    data-at-rest protection </text>
                    <M ref="I"/>
		    <app-note>
		      Function <xref to="mf-rmediaDar"/> is implicitly met if the TSF does not support
		      removable media.
		    </app-note>
		    <aactivity><Tests>
		      The evaluator shall exercise the TSF configuration as the administrator and,
                    if not restricted to the administrator, the user, to enable removable media’s
                    data-at-rest protection according to the AGD guidance. The evaluator shall
                    ensure that all Evaluation Activities for DAR (FDP_DAR) are conducted with the
                    device in this configuration.
		    </Tests></aactivity>
                </management-function>
                <management-function id="mf-location">
                  <text>
                    <!-- 21. -->
                    <!-- <ctr id="location" pre="" ctr-type="function">.</ctr>--> enable/disable location
                    services: <h:ul>
                      <h:li>Across device</h:li></h:ul>
                    <h:div class="indent"><selectables linebreak="yes">
                        <selectable id="mf-location-per_app">on a per-app basis</selectable>
                        <selectable>on a per-group of applications processes basis</selectable>
                        <selectable exclusive="yes">no other method</selectable>
                      </selectables></h:div>
                  </text>
                  <M ref="I"/>
		  <app-note>
		                  For function <xref to="mf-location"/>, location
              services include location information gathered from GPS, cellular, and Wi-Fi.

		  </app-note>
		  <aactivity><Tests>
		    The evaluator shall perform the following tests. <testlist>
                      <test>The evaluator shall enable location services device-wide and shall
                        verify that an application (such as a mapping application) is able to access
                        the TOE’s location information. The evaluator shall disable location
                        services device-wide and shall verify that an application (such as a mapping
                        application) is unable to access the TOE’s location information. </test>
                      <test>[conditional] If <xref to="mf-location-per_app"/> is selected, the evaluator shall
                        create two applications and enable one to use access the location services
                        and the other to not access the location services. The evaluator shall
                        exercise each application attempting to access location services
                        individually. The evaluator shall verify that the enabled application is
                        able to access the location services and the disabled application is not
                        able to access the location services. </test>
                    </testlist></Tests></aactivity>
                </management-function>
                <management-function id="mf-authFactors">
                  <text>
                    <!-- <ctr id="authFactors" pre="" ctr-type="function">.</ctr>--> enable/disable the use
                    of <selectables>
                      <selectable>Biometric Authentication Factor</selectable>
                      <selectable>Hybrid Authentication Factor</selectable>
                    </selectables>
                  </text>
		  <app-note>
		    Function <xref to="mf-authFactors"/> must be included in the ST if the TOE contains a BAF. This selection must correspond with the selection made in
              FIA_UAU.5.1. If <xref to="uau_biometric"/> is selected in FIA_UAU.5.1, "Biometric Authentication Factor"
              must be selected and the user or admin must have the option to disable the use of
              it. If multiple BAFs are claimed in FIA_MBV_EXT.1.1 in the <xref to="mod-biometrics"/>, this applies to all different
              modalities. If <xref to="uau_hybr"/> is selected in FIA_UAU.5.1 it must be selected and the user
              or admin must have the option to disable the use of it.
		  </app-note>
		  <aactivity><Tests>
		    The evaluator shall verify that the TSS states if the TOE supports a BAF
                    or hybrid authentication. If the TOE does not include a BAF or hybrid
                    authentication this test is implicitly met.<testlist>
                      <test>[conditional] If <xref to="uau_biometric"/> is selected in FIA_UAU.5.1, for each BAF claimed in FIA_MBV_EXT.1.1 in the <xref to="mod-biometrics"/> the evaluator shall verify that the
                        TSS describes the procedure to enable/disable the BAF.<!--If the TOE includes
                        multiple BAFs, the evaluator shall verify that the TSS describes how to
                        enable/disable each BAF, specifically if the different modalities can be
                        individually enabled/disabled.--> The evaluator shall configure the TOE to
                        allow each supported BAF to authenticate and verify that successful
                        authentication can be achieved using the BAF. The evaluator shall configure
                        the TOE to disable the use of each supported BAF for authentication and
                        confirm that the BAF cannot be used to authenticate. </test>
                      <test>[conditional] If <xref to="uau_hybr"/> is selected the evaluator shall verify that
                        the TSS describes the procedure to enable/disable the hybrid (biometric
                        credential and PIN/password) authentication. The evaluator shall configure
                        the TOE to allow hybrid authentication to authenticate and confirm that
                        successful authentication can be achieved using the hybrid authentication.
                        The evaluator shall configure the TOE to disable the use of hybrid
                        authentication and confirm that the hybrid authentication cannot be used to
                        authenticate. </test>
                        </testlist>
                    </Tests></aactivity>
                </management-function>
                <management-function id="mf-certInvalid">
                  <text>
                    <!-- <ctr id="certInvalid" pre="" ctr-type="function">.</ctr>--> configure whether to
                    allow or disallow establishment of <assignable>configurable trusted channel in FTP_ITC_EXT.1.1 or FDP_UPC_EXT.1.1/APPS</assignable> if the peer or server certificate
                    is deemed invalid.</text>
		    <app-note>
		                    <!-- TODO: Should this be something like for TLS do not approve any exceptions, for HTTP this is per FCS_HTTPS_EXT.1.3?? How do I force the selection of no exceptions for all (non-HTTPS) TLS connections? -->
              Function <xref to="mf-certInvalid"/> must be included in the ST if the function is configurable on the TOE for any of the trusted channels either mandated or selected in <xref to="fel-wlan"/> or <xref to="fel-tls-app"/>. The configuration can be different depending on the specific trusted channel(s) and they must be filled in for the assignment.
		    </app-note>
                  <aactivity><Tests>The test of this function is performed in conjunction with FIA_X509_EXT.2.2 in <xref to="pkg-x509"/>,
                    FCS_TLSC_EXT.1.6 in the <xref to="pkg-tls"/>. </Tests></aactivity>
                </management-function>
                <!-- Start of the Optional to implement functions -->
                <management-function id="mf-externalPorts">
                  <text>
                    <!-- <ctr id="externalPorts" pre="" ctr-type="function">.</ctr>--> enable/disable all
                    data signaling over <assignable>list of externally accessible hardware
                      ports</assignable>
                  </text>
		  <app-note>
		                  <!-- Start of the optional to include functions --> The assignment in function
                <xref to="mf-externalPorts"/> consists of all externally accessible hardware
              ports, such as USB, the SD card, and HDMI, whose data transfer capabilities can be
              enabled and disabled by either the user or administrator. Disablement of data transfer
              over an external port must be effective during and after boot into the normal
              operative mode of the device. If the TOE supports states in which configured security
              management policy is inaccessible, for example, due to data-at-rest protection, it is
              acceptable to meet this requirement by ensuring that data transfer is disabled by
              default while in these states. Each of the ports may be enabled or disabled
              separately. The configuration policy need not disable all ports together. In the case
              of USB, charging is still allowed if data transfer capabilities have been disabled.

		  </app-note>
		  <aactivity><TSS>
		    The evaluator shall verify that the TSS includes a list of each externally
                    accessible hardware port and an indication of if data transfer over that port can
                    be enabled/disabled. AGD guidance will describe how to perform the enable/disable function.</TSS>
		    <Tests>The evaluator shall exercise the TSF configuration to enable and disable
                    data transfer capabilities over each externally accessible hardware ports (e.g.
                    USB, SD card, HDMI) listed by the ST author. The evaluator shall use test
                    equipment for the particular interface to ensure that while the TOE may continue to 
                    receive data on the RX pins, it is not responding on TX pins used for data transfer when they are disabled. For each
                    disabled data transfer capability, the evaluator shall repeat this test by
                    rebooting the device into the normal operational mode and verifying that the
                    capability is disabled throughout the boot and early execution stage of the
                    device.</Tests>
		    </aactivity>
                </management-function>
                <management-function id="mf-serverProtocols">
                  <text>
                    <!-- <ctr id="serverProtocols" pre="" ctr-type="function">.</ctr>--> enable/disable
                      <assignable id="a-server">list of protocols where the device acts as a server</assignable>
                  </text>
		  <app-note>
		    The assignment in function <xref to="mf-serverProtocols"/>
              consists of all protocols where the TSF acts as a server, which can be enabled and
              disabled by either the user or administrator.
		  </app-note>
		  <aactivity><TSS>
		    The evaluator shall verify that the TSS describes how the TSF acts as a server in
                  each of the protocols listed in the ST, and the reason for acting as a server.</TSS>
		    <Tests>
		    The evaluator shall attempt to disable each listed protocol in the
                    assignment. The evaluator shall verify that remote devices can no longer access
                    the TOE or TOE resources using any disabled protocols.
		    </Tests>
		    </aactivity>
                </management-function>
                <management-function id="mf-devModes">
                  <text>
                    <!-- <ctr id="devModes" pre="" ctr-type="function">.</ctr>--> enable/disable developer
                  modes </text>
		  <app-note>
		    Function <xref
                to="mf-devModes"/> must be included in the selection if developer modes are
		    supported by the TSF.
		  </app-note>
		  <aactivity><Tests>
		    The evaluator shall exercise the TSF configuration as the administrator and,
                    if not restricted to the administrator, the user, to enable and disable any
                    developer mode. The evaluator shall test that developer mode access is not
                    available when its configuration is disabled. The evaluator shall verify the
                    developer mode remains disabled during device reboot.</Tests></aactivity>
                </management-function>
                <management-function id="mf-authBypass">
                  <text>
                    <!-- <ctr id="authBypass" pre="" ctr-type="function">.</ctr>--> enable/disable bypass of
                  local user authentication </text>
		  <app-note>
		    Function <xref to="mf-authBypass"/> must
              be included in the selection if bypass of local user authentication, such as a "Forgot
              Password", password hint, or remote authentication feature, is supported.

		  </app-note>
		  <aactivity><Guidance>The
                  evaluator shall examine the AGD guidance to determine that it describes how to
                  enable and disable any "Forgot Password", password hint, or remote authentication
                  (to bypass local authentication mechanisms) capability.
		</Guidance>
		<Tests>For each mechanism listed in the AGD guidance that provides a "Forgot
                    Password" feature or other means where the local authentication process can be
                    bypassed, the evaluator shall disable the feature and ensure that they are not
                    able to bypass the local authentication process.</Tests></aactivity>
                </management-function>
                <management-function id="mf-wipeEntData">
                  <text>
                    <!-- <ctr id="wipeEntData" pre="" ctr-type="function">.</ctr>--> wipe Enterprise data </text>
                    <NA ref="AO"/>
		    <aactivity><Tests>
		      The evaluator shall attempt to wipe Enterprise data resident on the device
                    according to the administrator guidance. The evaluator shall verify that the
                    data is no longer accessible by the user.</Tests></aactivity>
                </management-function>
                <management-function id="mf-appCert">
                  <text>
                    <!-- <ctr id="appCert" pre="" ctr-type="function">.</ctr>--> approve <selectables>
                      <selectable>import</selectable>
                      <selectable>removal</selectable>
                    </selectables> by applications of X.509v3 certificates in the Trust Anchor
                  Database </text>
		  <app-note>
		    Function <xref to="mf-appCert"/> must be included in the
              selection if the TSF allows applications, other than the MDM Agents, to import or
              remove X.509v3 certificates from the Trust Anchor Database. The MDM Agent is
              considered the administrator. This function does not apply to applications trusting a
              certificate for its own validations. The function only applies to situations where the
              application modifies the device-wide Trust Anchor Database, affecting the validations
              performed by the TSF for other applications. The user or administrator may be provided
              the ability to globally allow or deny any application requests in order to meet this
              requirement.
		  </app-note>
		  <aactivity><TSS>
		    The
                  evaluator shall verify that the TSS describes how approval for an application to
                  perform the selected action (import, removal) with respect to certificates in the
                  Trust Anchor Database is accomplished (e.g., a pop-up, policy setting, etc.).
                  <h:br/><h:br/> The evaluator shall also verify that the API documentation
                  provided according to <xref to="adv"/> includes any security functions
                  (import, modification, or destruction of the Trust Anchor Database) allowed by applications.
		</TSS>
		<Tests>The evaluator shall perform one of the following tests: <testlist>
                      <test>[conditional] If applications may import certificates to the Trust
                        Anchor Database, the evaluator shall write, or the developer shall provide
                        access to, an application that imports a certificate into the Trust Anchor
                        Database. The evaluator shall verify that the TOE requires approval before
                        allowing the application to import the certificate: <h:ul>
                          <h:li>The evaluator shall deny the approvals to verify that the
                            application is not able to import the certificate. Failure of import
                            shall be tested by attempting to validate a certificate that chains to
                            the certificate whose import was attempted (as described in the
                            evaluation activity for FIA_X509_EXT.1 as defined in <xref to="pkg-x509"/>). </h:li>
                          <h:li>The evaluator shall repeat the test, allowing the approval to
                            verify that the application is able to import the certificate and that
                            validation occurs. </h:li>
                        </h:ul>
                      </test>
                      <test>[conditional] If applications may remove certificates in the Trust
                        Anchor Database, the evaluator shall write, or the developer shall provide
                        access to, an application that removes certificates from the Trust Anchor
                        Database. The evaluator shall verify that the TOE requires approval before
                        allowing the application to remove the certificate: <h:ul>
                          <h:li>The evaluator shall deny the approvals to verify that the
                            application is not able to remove the certificate. Failure of removal
                            shall be tested by attempting to validate a certificate that chains to
                            the certificate whose removal was attempted (as described in the
                            evaluation activity for FIA_X509_EXT.1 as defined in <xref to="pkg-x509"/>). </h:li>
                        </h:ul>
                      </test>
                    </testlist> The evaluator shall repeat the test, allowing the approval to verify
                    that the application is able to remove/modify the certificate and that
                    validation no longer occurs.
		    </Tests>
		  </aactivity>
		</management-function>
                <management-function id="mf-certValidity">
                  <text>
                    <!-- <ctr id="certValidity" pre="" ctr-type="function">.</ctr>--> configure whether to
                    allow or disallow establishment of a trusted channel if the TSF cannot establish a
                  connection to determine the validity of a certificate</text>
		  <app-note>
		    Function <xref to="mf-certValidity"/> must be
              included in the ST if "administrator is allowed to configure certificate acceptance" is selected in
              FIA_X509_EXT.2.2 in <xref to="pkg-x509"/>
		  </app-note>
                  <aactivity><Tests>The test of this function is performed in conjunction with FIA_X509_EXT.2.2 in <xref to="pkg-x509"/>.</Tests></aactivity>
                </management-function>
                <management-function id="mf-cellular">
                  <text>
                    <!-- <ctr id="cellular" pre="" ctr-type="function">.</ctr>--> enable/disable the
                  cellular protocols used to connect to cellular network base stations </text>
		  <aactivity><TSS>The
                  evaluator shall ensure that the TSS describes which cellular protocols can be
                  disabled.</TSS>
		  <Guidance>The evaluator shall confirm that the AGD guidance describes the
                  procedure for disabling each cellular protocol identified in the TSS.
		  </Guidance>
		  <Tests>The evaluator shall attempt to disable each cellular protocol according to
                    the administrator guidance. The evaluator shall attempt to connect the device to
                    a cellular network and, using network analysis tools, verify that the device
                    does not allow negotiation of the disabled protocols.</Tests></aactivity>
                </management-function>
                <management-function id="mf-auditLogs">
                  <text>
                    <!-- <ctr id="auditLogs" pre="" ctr-type="function">.</ctr>--> read audit logs kept by
                    the TSF </text>
                    <NA ref="AO"/>
		    <aactivity><Tests>The evaluator shall attempt to read any device audit logs according to the
                    administrator guidance and verify that the logs may be read. This test may be
                    performed in conjunction with the evaluation activity of FAU_GEN.1.</Tests></aactivity>
                </management-function>
                <management-function id="mf-digSign">
                  <text>
                    <!-- <ctr id="digSign" pre="" ctr-type="function">.</ctr>--> configure <selectables>
                      <selectable>certificate</selectable>
                      <selectable>public-key</selectable>
                  </selectables> used to validate digital signature on applications </text>
		  <app-note>
		    Function <xref to="mf-digSign"/> should be
              included in the selection if FPT_TUD_EXT.5.1 is included in the ST and the
              configurable option is selected.
		  </app-note>
		  <aactivity><Tests>
		    The test of this function is performed in conjunction with FPT_TUD_EXT.5.1.
		  </Tests></aactivity>
                </management-function>
                <management-function id="mf-sharedKeys">
                  <text>
                    <!-- <ctr id="sharedKeys" pre="" ctr-type="function">.</ctr>--> approve exceptions for
                  shared use of keys or secrets by multiple applications </text>
		  <app-note>
		    Function <xref
                to="mf-sharedKeys"/> should be included in the selection if user or administrator is
		    selected in FCS_STG_EXT.1.4.
		  </app-note>
		  <aactivity><TSS>The
                  evaluator shall verify that the TSS describes how the approval for exceptions for
                  shared use of keys or secrets by multiple applications is accomplished (e.g., a
                  pop-up, policy setting, etc.).</TSS><Tests>
		  The test of this function is performed in conjunction with FCS_STG_EXT.1.
		  </Tests></aactivity>
                </management-function>
                <management-function id="mf-keyWipeRules">
                  <text>
                    <!-- <ctr id="keyWipeRules" pre="" ctr-type="function">.</ctr>--> approve exceptions for
                    destruction of keys or secrets by applications that did not import the key or secret
                  </text>
		  <app-note>
		    Function <xref to="mf-keyWipeRules"/> should be included in the selection if
		    <xref to="s-killkey-user"/> or <xref to="s-killkey-admin"/>
		    is selected in FCS_STG_EXT.1.5.
		    <rule id="r-killkey-user-mf">
		      <if><ref-id>s-killkey-user</ref-id></if>
		      <then><ref-id>mf-keyWipeRules</ref-id></then>
		    </rule>
		    <rule id="r-killkey-admin-mf">
		      <if><ref-id>s-killkey-admin</ref-id></if>
		      <then><ref-id>mf-keyWipeRules</ref-id></then>
		    </rule>
		  </app-note>
		<aactivity><TSS>The
                  evaluator shall verify that the TSS describes how the approval for exceptions for
                  destruction of keys or secrets by applications that did not import the key or secret is
                  accomplished (e.g., a pop-up, policy setting, etc.).
		  </TSS><Tests>
		  The test of this function is performed in conjunction with FCS_STG_EXT.1.
		</Tests>
		</aactivity>
                </management-function>
                <management-function id="mf-unlockBanner">
                  <text>
                    <!-- <ctr id="unlockBanner" pre="" ctr-type="function">.</ctr>--> configure the unlock
                    banner </text>
                    <M ref="I"/> <NA ref="U"/>
		    <app-note>
		      <!-- ToDo Removed because FTA_TAB is now mandatory: Function <xref to="mf-unlockBanner"/> must be
		      included in the selection if FTA_TAB.1 is included in the ST. !-->
		    </app-note>
		    <aactivity><TSS>
                  The evaluator shall verify that the TSS describes any restrictions in banner
                  settings (e.g., character limitations).
		  </TSS><Tests>
		  The test of this function is performed in conjunction with FTA_TAB.1.
		    </Tests></aactivity>
		</management-function>
                <management-function id="mf-auditItems">
                  <text>
                    <!-- <ctr id="auditItems" pre="" ctr-type="function">.</ctr>--> configure the auditable
                    items </text>
                    <NA ref="U"/>
		    <app-note>
		                    Function <xref to="mf-auditItems"/> must be included in the selection if FAU_SEL.1
				    is included in the ST.
		    </app-note>
		    <aactivity><Tests>The test of this function is performed in conjunction with FAU_SEL.1.</Tests></aactivity>
                </management-function>
                <management-function id="mf-integ">
                  <text>
                    <!-- <ctr id="integ" pre="" ctr-type="function">.</ctr>--> retrieve TSF-software
                  integrity verification values </text>
		  <aactivity><Tests>The test of this function is performed in conjunction with FPT_NOT_EXT.2.1.</Tests></aactivity>
                </management-function>
                <management-function id="mf-USB">
                  <text>
                    <!-- <ctr id="USB" pre="" ctr-type="function">.</ctr>--> enable/disable <selectables
                      linebreak="yes">
                      <selectable id="s-usbstore">USB mass storage mode</selectable>
                      <selectable>USB data transfer without user authentication</selectable>
                      <selectable>USB data transfer without authentication of the connecting
                        system</selectable>
                    </selectables>
                  </text>
		  <aactivity><TSS>The
                  evaluator shall verify that the TSS includes a description of how data transfers
                  can be managed over USB.</TSS>
                  <Tests>The evaluator shall perform the following tests based on the selections made
                    in the table: <testlist>
                      <test>[conditional] The evaluator shall disable USB mass storage mode,
                        attach the device to a computer, and verify that the computer cannot mount
                        the TOE as a drive. The evaluator shall reboot the TOE and repeat this test
                        with other supported auxiliary boot modes. </test>
                      <test>[conditional] The evaluator shall disable USB data transfer without
                        user authentication, attach the device to a computer, and verify that the
                        TOE requires user authentication before the computer can access TOE data.
                        The evaluator shall reboot the TOE and repeat this test with other supported
                        auxiliary boot modes. </test>
                      <test>[conditional] The evaluator shall disable USB data transfer without
                        connecting system authentication, attach the device to a computer, and
                        verify that the TOE requires connecting system authentication before the
                        computer can access TOE data. The evaluator shall then connect the TOE to
                        another computer and verify that the computer cannot access TOE data. The
                        evaluator shall then connect the TOE to the original computer and verify
                        that the computer can access TOE data. </test>
                      </testlist></Tests>
		      </aactivity>
                </management-function>
                <management-function id="mf-backup">
                  <text>
                    <!-- <ctr id="backup" pre="" ctr-type="function">.</ctr>--> enable/disable backup of <selectables>
                      <selectable id="s-backup-all-apps">all applications</selectable>
                      <selectable id="s-backup-sel-apps">selected applications</selectable>
                      <selectable id="s-backup-sel-grps">selected groups of applications</selectable>
                      <selectable id="s-backup-cfg">configuration data</selectable>
                    </selectables> to <selectables>
                      <selectable>locally connected system</selectable>
                      <selectable>remote system</selectable>
                    </selectables>
                  </text>
		  <aactivity><TSS>The
                  evaluator shall verify that the TSS includes a description of available backup
                  methods that can be enabled/disabled. If "selected applications" or "selected groups
                  of applications" are selected the TSS shall include which applications of groups of
                  applications backup can be enabled/disabled.</TSS>
                  
                <Tests> If <xref to="s-backup-all-apps"/> is selected, the evaluator shall disable each selected
                    backup location in turn and verify that the TOE cannot complete a backup. The
                    evaluator shall then enable each selected backup location in turn and verify
                    that the TOE can perform a backup. <h:br/><h:br/>
		    
		    If <xref to="s-backup-sel-apps"/> is selected,
		    the evaluator shall disable each selected backup location in turn
                    and verify that for the selected application the TOE prevents backup from
                    occurring. The evaluator shall then enable each selected backup location in turn
                    and verify that for the selected application the TOE can perform a backup.
                    <h:br/><h:br/>
		    
		    If <xref to="s-backup-sel-grps"/> is selected, the
                    evaluator shall disable each selected backup location in turn and verify that
                    for a group of applications the TOE prevents the backup from occurring. The
                    evaluator shall then enable each selected backup location in turn and verify for
                    the group of application the TOE can perform a backup. <h:br/><h:br/>
		    
		    If <xref to="s-backup-cfg"/> is selected, the evaluator shall disable each selected
                    backup location in turn and verify that the TOE prevents the backup of
                    configuration data from occurring. The evaluator shall then enable each selected
                    backup location in turn and verify that the TOE can perform a backup of
                    configuration data.
		    </Tests></aactivity>
                </management-function>
                <management-function id="mf-hotspot">
                  <text>
                    <!-- <ctr id="hotspot" pre="" ctr-type="function">.</ctr>--> enable/disable <selectables
                      linebreak="yes">
                      <selectable>Hotspot functionality authenticated by <selectables>
                          <selectable>pre-shared key</selectable>
                          <selectable>passcode</selectable>
                          <selectable exclusive="yes">no authentication</selectable>
                        </selectables></selectable>
                      <selectable id="s-tether"><snip>USB tethering</snip> authenticated by <selectables>
                          <selectable>pre-shared key</selectable>
                          <selectable>passcode</selectable>
                          <selectable exclusive="yes">no authentication</selectable>
                        </selectables>
                      </selectable>
                    </selectables>
                  </text>
		  <app-note>
		    For function <xref to="mf-hotspot"/>,
              hotspot functionality refers to the condition in which the MD is serving as
              an access point to other devices, not the connection of the TOE to external hotspots.

		  </app-note>
		  <aactivity><TSS> The
                  evaluator shall verify that the TSS includes a description of Hotspot
                  functionality and USB tethering to include any authentication for these.</TSS>
		  <Tests>The evaluator shall perform the following tests based on the selections in
                    Function <xref to="mf-hotspot"/>. <testlist>
                      <test>[conditional] The evaluator shall enable hotspot functionality with
                        each of the of the support authentication methods. The evaluator shall
                        connect to the hotspot with another device and verify that the hotspot
                        functionality requires the configured authentication method. </test>
                      <test>[conditional] The evaluator shall enable USB tethering functionality
                        with each of the of the support authentication methods. The evaluator shall
                        connect to the TOE over USB with another device and verify that the
                        tethering functionality requires the configured authentication method.
                      </test>
                    </testlist></Tests></aactivity>
                </management-function>
                <management-function id="mf-dataSharing">
                  <text>
                    <!-- <ctr id="dataSharing" pre="" ctr-type="function">.</ctr>--> approve exceptions for
                    sharing data between <selectables>
                      <selectable>applications</selectable>
                      <selectable>groups of applications</selectable>
                  </selectables></text>
		  <app-note>
		    Functions <xref to="mf-dataSharing"/> and <xref
                    to="mf-appGroups"/> correspond to FDP_ACF_EXT.1.2.
		  </app-note>
		  <aactivity><Tests>The test of this function is performed in conjunction with FDP_ACF_EXT.1.2.</Tests></aactivity>
                </management-function>
                <management-function id="mf-appGroups">
                  <text>
                    <!-- <ctr id="appGroups" pre="" ctr-type="function">.</ctr>--> place applications into
                    application groups based on <assignable>enterprise configuration
                  settings</assignable></text>
		  <aactivity><Tests>
		    The evaluator shall set a policy to cause a designated application to be
                    placed into a particular application group. The evaluator shall then install the
                    designated application and verify that it was placed into the correct group.
		    </Tests></aactivity>
                </management-function>
                <management-function id="mf-unenroll">
                  <text>
                    <!-- <ctr id="unenroll" pre="" ctr-type="function">.</ctr>--> unenroll the TOE from
                  management </text>
		  <app-note>
		    For function
                <xref to="mf-unenroll"/>, FMT_SMF_EXT.2.1 specifies actions to be performed when
		the TOE is unenrolled from management.
		  </app-note>
		  <aactivity><Tests>The evaluator shall attempt to unenroll the device from management and
                    verify that the steps described in FMT_SMF_EXT.2.1 are performed. This test
                    should be performed in conjunction with the FMT_SMF_EXT.2.1 evaluation activity.
		    </Tests></aactivity>
                </management-function>
                <management-function id="mf-alwaysOnVPN">
                  <text>
                    <!-- <ctr id="alwaysOnVPN" pre="" ctr-type="function">.</ctr>--> enable/disable the
                    Always On VPN protection:
                    <h:ul>
                      <h:li>Across device</h:li></h:ul>
                    <h:div class="indent"><selectables linebreak="yes">
                      <selectable>on a per-app basis</selectable>
                      <selectable>on a per-group of applications processes basis</selectable>
                      <selectable exclusive="yes">no other method</selectable>
                    </selectables></h:div>                
                  </text>
		  <app-note>
		    Function <_/> must be included in the ST if IPsec is selected in
              FTP_ITC_EXT.1 and the native IPsec VPN client can be configured to be Always-On.
              Always-On is defined as when the TOE has a network connection the VPN attempts to
              connect, all data leaving the device uses the VPN when the VPN is connected and no
              data leaves that device when the VPN is disconnected. The configuration of the VPN
              Client itself (with information such as VPN Gateway, certificates, and algorithms) is
              addressed by the <xref to="mod-vpnclient"/>.
		  </app-note>
		  <aactivity><TSS>The evaluator shall verify that the TSS contains guidance to configure the
                  VPN as Always-On.
		  </TSS><Tests>The evaluator shall configure the VPN as Always-On and perform the following tests:
                    <testlist>
                      <test>The evaluator shall verify that when the VPN is connected all traffic
                        is routed through the VPN. This test is performed in conjunction with
                        FDP_IFC_EXT.1.1. </test>
                      <test>The evaluator shall verify that when the VPN is not established, that
                        no traffic leaves the device. The evaluator shall ensure that the TOE has
                        network connectivity and that the VPN is established. The evaluator shall
                        use a packet sniffing tool to capture the traffic leaving the TOE. The
                        evaluator shall disable the VPN connection on the server side. The evaluator
                        shall perform actions with the device such as navigating to websites, using
                        provided applications, and accessing other Internet resources and verify
                        that no traffic leaves the device. </test>
                      <test>The evaluator shall verify that the TOE has network connectivity and
                        that the VPN is established. The evaluator shall disable network
                        connectivity (i.e. Airplane Mode) and verify that the VPN disconnects. The
                        evaluator shall re-establish network connectivity and verify that the VPN
                        automatically reconnects. </test>
                    </testlist>
		  </Tests></aactivity>
                </management-function>
                <management-function id="mf-bioRevoke">
                  <text>
                    <!-- <ctr id="bioRevoke" pre="" ctr-type="function">.</ctr>--> revoke Biometric
                  template</text>
		  <aactivity><TSS>The evaluator shall verify that the TSS describes the procedure to revoke a
                  biometric credential stored on the TOE.
		  </TSS><Tests>The evaluator shall configure the TOE to
                    use BAF and confirm that the biometric can be used to authenticate to the
                    device. The evaluator shall revoke the biometric credential’s ability to
                    authenticate to the TOE and confirm that the same BAF cannot be used to
                    authenticate to the device.
		  </Tests></aactivity>
                </management-function>
                <management-function id="mf-other">
                  <text>
                    <!-- <ctr id="other" pre="" ctr-type="function">.</ctr>-->
                    <assignable>list of other management functions to be provided by the
                  TSF</assignable></text>
		  <aactivity><TSS> The evaluator shall
                  verify that the TSS describes all assigned security management functions and their
                  intended behavior.
		  </TSS>
                  <Tests>The evaluator shall design and perform tests to demonstrate that the
                    function may be configured and that the intended behavior of the function is
                    enacted by the TOE.
		    </Tests></aactivity>
                </management-function>
              </management-function-set>
            </title>
              </xpath-specified>
            </replace>
          </base-sfr-spec>
        </section>
        
      </modified-sfrs>
      <additional-sfrs>
        
        <!-- Audit table for Additional SFRs -->
        <section id="sec-at-gpos-addnl" title="Auditable Events for GPOS PP Additional SFRs">
          <audit-table id="at-gpos-addnl" table="tab-at-gpos-addnl" title="Auditable Events for GPOS PP Additional SFRs"/>
        </section>
        
        
        
        <sec:gpos_add_ftp title="Trusted Path/Channels (FTP)">
          <f-component cc-id="ftp_itc_ext.1" name="Trusted Channel Communication" iteration="OSCHANNEL">
            <consistency-rationale> The Base-PP includes FTP_ITC_EXT.1 to define the secure protocols used for trusted channel communications. 
              This PP-Module iterates the SFR to specify a subset of these protocols that may be used for MDM Agent communications in particular. </consistency-rationale>
            <f-element id="gpos-mut-chan-type">
              <title>The OS shall use 
                <selectables>
                  <selectable><h:b>mutually authenticated</h:b> TLS as conforming to <xref to="pkg-tls"/> as a [<h:i>client</h:i>]</selectable>
                  <selectable><h:b>mutually authenticated</h:b> DTLS as conforming to <xref to="pkg-tls"/> as a [<h:i>client</h:i>]</selectable>
                </selectables>
                to provide a trusted communication channel between itself and authorized IT
                entities supporting the following capabilities: [<h:i>[MDM Server communications, 
                  <selectables>
                    <selectable>MAS Server communications</selectable>
                    <selectable>no other communications</selectable></selectables>]</h:i>]
                that is logically distinct from other communication channels and provides
                assured identification of its end points and protection of the channel data from
                disclosure and detection of modification of the channel data.
              </title>
              <note role="application"> The intent of this requirement is to protect the
                communications channel between MDM Server and Agent, post
                enrollment. FTP_TRP.1/OSENROLL is to protect the communications
                channel between MDM Server and Agent during enrollment.
                <h:br/><h:br/> 
                This requirement is to ensure that the transmission of any audit
                logs, system data (hardware, software, or application), and configuration data collected by the MDM
                Agent and sent from the MDM Agent to the MDM
                Server, when commanded, or at configurable intervals, is properly protected. This
                trusted channel also protects any commands and policies sent by the MDM Server to the MDM Agent. 
                Either the MDM Agent or the MDM Server is able to initiate the
                connection.
                <h:br/><h:br/> 
                This requirement is iterated from the GPOS PP to indicate the protocols that the MDM Agent can use for a trusted
                channel. The operating system is required to perform the mandated cryptographic
                protocols as in the Base-PP for communication channels mandated in
                the GPOS PP. The ST author must select one of
                TLS or DTLS in order to establish and maintain a trusted channel between the
                  MDM Agent and the MDM Server. Only TLS or DTLS are acceptable for this trusted channel.<h:br/><h:br/> 
                Since this
                requirement is only for the case when the PP-Module builds on the GPOS
                PP, and in this case it is expected that the MDM Agent will be a
                native part of the operating system, it is expected that the MDM Agent will use the operating system's implementation of the
                selected protocols. Depending on whether "TLS" or "DTLS" is selected, the following selections from
                the <xref to="pkg-tls"/> must be made: <h:ul>
                  <h:li>FCS_TLS_EXT.1: <h:ul>
                      <h:li>Either TLS or DTLS is selected depending on the selection made in
                        <xref to="gpos-mut-chan-type"/>.</h:li>
                      <h:li>Client must be selected.</h:li>
                    </h:ul>
                  </h:li>
                  <h:li>FCS_TLSC_EXT.1.1: <h:ul>
                      <h:li>The cipher suites selected must correspond with the algorithms and
                        hash functions allowed in FCS_COP.1 from the GPOS PP.</h:li>
                      <h:li>Mutual authentication must be selected.</h:li>
                    </h:ul>
                  </h:li>
                </h:ul> Protocol, RBG, certificate validation, algorithm, and similar services may
                be met with platform provided services. <h:br/><h:br/>
              </note>
            
              <aactivity>
                <TSS>The evaluator shall examine the TSS to determine that the
                  methods of communication between the MDM Agent and MDM Server (and MAS Server, if claimed) are indicated, along with how those
                  communications are protected. The evaluator shall also confirm that all protocols
                  listed in the TSS in support of remote TOE
                  administration are consistent with those specified in the requirement, and are
                  included in the requirements in the ST.<h:br/><h:br/>
                </TSS>
                <Guidance> The evaluator shall confirm that the operational guidance contains
                  instructions for configuring the communication channel between the MDM Agent and
                  the MDM Server and conditionally, the MAS Server for each supported
                  method.<h:br/><h:br/>
                </Guidance>
                <Tests>For each supported identifier type (excluding DNs), the evaluator shall
                  repeat the following tests:<h:br/><h:br/>
                  <testlist>
                    <test>The evaluator shall ensure that communications using each specified (in
                      the operational guidance) communication method between the MDM Agent and MDM Server (and MAS Server, if claimed) is tested during
                      the course of the evaluation, connections are set up as described in the operational guidance, and that communication is successful.
                    </test>
                    <test>The evaluator shall ensure, for each method of communication between the MDM Agent and MDM Server (and MAS Server, if claimed),
                      the channel data is not sent in plaintext.
                    </test>
                    <test>The evaluator shall ensure, for each communication channel between the MDM Agent and MDM Server
                      (and MAS Server, if claimed), that a protocol analyzer identifies the traffic as the protocol under
                      testing.
                    </test>
                  </testlist> 
                    <h:br/>
                    Further evaluation activities are associated with the specific protocols.<h:br/><h:br/>
                </Tests>
              </aactivity>
            </f-element>
            <audit-event table="tab-at-gpos-addnl">
              <audit-event-descr>Initiation of the trusted channel.</audit-event-descr>
              <audit-event-info>No additional information.</audit-event-info>
            </audit-event>
            <audit-event table="tab-at-gpos-addnl">
              <audit-event-descr>Termination of the trusted channel.</audit-event-descr>
              <audit-event-info>No additional information.</audit-event-info>
            </audit-event>
            <audit-event table="tab-at-gpos-addnl">
              <audit-event-descr>Failure of the trusted channel functions.</audit-event-descr>
              <audit-event-info>No additional information.</audit-event-info>
            </audit-event>
          </f-component>
          <f-component cc-id="ftp_trp.1" name="Trusted Path (for Enrollment)" iteration="OSENROLL">
            <consistency-rationale>This SFR uses the trusted channel protocols defined by the Base-PP in FTP_ITC_EXT.1 to facilitate a trusted path that the 
              MDM Agent can use to enroll the operating system it runs on into
              management. The GPOS PP already defines an iteration of this SFR for trusted administration, so this
              SFR is iterated to illustrate that this trusted path is used for a distinct function.</consistency-rationale>
            <f-element>
              <title>The <h:b>TSF</h:b> shall provide a communication path between itself and <h:b>a</h:b> [<h:i>remote</h:i>] <h:b>MDM Server</h:b> that is 
                logically distinct from other communication paths
                and provides assured identification of its endpoints and protection of the
                communicated data from [<h:i>modification, disclosure</h:i>].
              </title>
            </f-element>
            <f-element>
              <title>The <h:b>TSF</h:b> shall permit <selectables>
                <selectable>local users</selectable>
                <selectable>remote users</selectable></selectables> to initiate communication via the trusted path.
              </title>
            </f-element>
            <f-element>
              <title>The <h:b>TSF</h:b> shall require the use of the trusted path for [<h:i>[MDM enrollment]</h:i>]. 
              </title>
              <note role="application">This requirement ensures that a trusted connection is used for initial enrollment to an MDM;
                security of ongoing MDM Server communications after enrollment is
                implemented through FTP_ITC_EXT.1/OSCHANNEL.
                <h:br/><h:br/> Since this requirement is only for the case when the PP-Module builds on GPOS PP, and in this case it is expected that the
                  MDM Agent will be a native part of the operating system,
                it is expected that the MDM Agent will use the operating system's
                implementation of a trusted protocol defined in the Base-PP SFR FTP_ITC_EXT.1 for this trusted path.
              </note>
              <aactivity>
                <TSS>The evaluator shall examine the TSS to determine that the
                  methods of remote enrollment are indicated, along with how those communications
                  are protected. The evaluator shall also confirm that all protocols listed in the
                    TSS in support of enrollment are consistent with those
                  specified in the requirement, and are included in the requirements in the ST.
                  <h:br/><h:br/>
                </TSS>
                <Guidance>The evaluator shall confirm that the operational guidance contains
                  instructions for establishing the enrollment sessions for each supported
                  method.<h:br/><h:br/>
                </Guidance>
                <Tests>For each enrollment method that the ST claims: <h:br/><h:br/>
                  <testlist>
                    <test>The evaluator shall ensure that communications using each specified (in
                      the operational guidance) enrollment method is tested during the course of the evaluation, 
                      connections are set up as described in the operational guidance, and that communication is successful.
                    </test>
                    <test>For each method of enrollment supported, the evaluator shall follow the
                      operational guidance to ensure that there is no available interface that can
                      be used by a remote user to establish enrollment sessions without invoking the
                      trusted path.
                    </test>
                    <test>The evaluator shall ensure, for each method of enrollment, the channel data
                      is not sent in plaintext.
                    </test>
                  </testlist> 
                    <h:br/>
                    Further evaluation activities are associated with the specific protocols.<h:br/><h:br/>
                </Tests>
              </aactivity>
            </f-element>
            <audit-event table="tab-at-gpos-addnl">
              <audit-event-descr>Initiation of the trusted path.</audit-event-descr>
              <audit-event-info>No additional information.</audit-event-info>
            </audit-event>
            <audit-event table="tab-at-gpos-addnl">
              <audit-event-descr>Termination of the trusted path.</audit-event-descr>
              <audit-event-info>No additional information.</audit-event-info>
            </audit-event>
            <audit-event table="tab-at-gpos-addnl">
              <audit-event-descr>Failure of the trusted path functions.</audit-event-descr>
              <audit-event-info>No additional information.</audit-event-info>
            </audit-event>
          </f-component>
        </sec:gpos_add_ftp>
      </additional-sfrs>
      <con-toe> When this PP-Module is used to extend the GPOS PP, the TOE type for
        the overall TOE is still a GPOS. The TOE boundary is simply extended to include the
          MDM Agent application that runs on that GPOS platform.</con-toe>
      <con-sec-prob/>
      <con-obj/>
      <con-op-en/>
      <con-mod ref="T.INSECURE_MDM_COMMUNICATIONS">This threat exploits network connectivity, consistent with T.NETWORK_EAVESDROP and T.NETWORK_ATTACK threats defined in the Base-PP.
      </con-mod>
      <con-mod ref="T.MISUSED_DEVICE">This threat exploits issues with local device configuration, consistent with the T.LOCAL_ATTACK threat defined in the Base-PP.
      </con-mod>
      <con-mod ref="T.UNAUTHORIZED_POLICY_SOURCE">This threat exploits malicious configuration which can enable a local attack, consistent with the T.LOCAL_ATTACK threat defined in the Base-PP can be realized.</con-mod>
      
      <con-mod ref="A.CONNECTIVITY">This assumption expects that networking services will be available for the TOE to use. 
        This is consistent with the Base-PP because the Base-PP includes mandatory requirements for a GPOS
        that have network connectivity as a prerequisite.</con-mod>
      <con-mod ref="A.PLATFORM">This assumption expects that the TOE’s underlying platform is sufficiently trusted. 
        This is consistent with the Base-PP by definition because the OS is within the TOE boundary and evaluated against the GPOS PP.</con-mod>
      <con-mod ref="A.PROPER_ADMIN">	
        The GPOS PP contains this same assumption with the same purpose.</con-mod>
      <con-mod ref="A.PROPER_USER">	
        The GPOS PP contains this same assumption with the same purpose.</con-mod>
      
      <con-mod ref="P.ACCOUNTABILITY">The Base-PP does not define any OSPs so any OSPs defined by the PP-Module 
        will not conflict with the Base-PP by definition.</con-mod>
      <con-mod ref="P.ADMIN">The Base-PP does not define any OSPs so any OSPs defined by the PP-Module 
        will not conflict with the Base-PP by definition.</con-mod>
      <con-mod ref="P.DEVICE_ENROLL">The Base-PP does not define any OSPs so any OSPs defined by the PP-Module 
        will not conflict with the Base-PP by definition.</con-mod>
      <con-mod ref="P.NOTIFY">The Base-PP does not define any OSPs so any OSPs defined by the PP-Module 
        will not conflict with the Base-PP by definition.</con-mod>
      
      
      <con-mod ref="OE.DATA_PROPER_ADMIN">This objective extends the Base-PP’s
        OE.PROPER_ADMIN objective by expecting that TOE administrators act appropriately when installing
        or configuring the MDM Agent.</con-mod>
      <con-mod ref="OE.DATA_PROPER_USER"> This objective extends the Base-PP’s
        OE.PROPER_USER objective by setting reasonable expectations for user security
        behavior.</con-mod>
        
      <con-mod ref="OE.IT_ENTERPRISE"> This objective helps mitigate the T.NETWORK_EAVESDROP and T.NETWORK_ATTACK
        threats defined by the Base-PP by reducing the network exposure of the
        operating system. This does not conflict with the Base-PP because the Base-PP does not set specific expectations for the level of security that the
        enterprise provides. However, all use cases from the Base-PP set expectations
        that the operating system is used for some enterprise purposes so it is reasonable to expect
        the enterprise have security controls in place to protect these functions. </con-mod>
      <con-mod ref="OE.DEVICE_PLATFORM">This extends the OE.PLATFORM objective from the Base-PP to cover that the underlying platform of the
        MDM Agent is trusted.</con-mod>
      <con-mod ref="OE.WIRELESS_NETWORK"> This objective is suitable because while the Base-PP does not define any availability metrics for wireless
        communications, it can be extended by a PP-Module for WLAN client capabilities, so support for wireless communications is a reasonable
        expectation for a GPOS.</con-mod>
        
      <con-mod ref="fau-alt-ext-2"> This SFR requires the MDM Agent to use a
        trusted channel defined by FTP_ITC_EXT.1 in the Base-PP to transmit data
        about its own behavior to the OE.</con-mod>
      <con-mod ref="fau-gen-1-agent">The Base-PP defines FAU_GEN.1; this PP-Module iterates the SFR to use the same audit mechanism to
        generate audit data for the MDM Agent’s behavior. It may alternatively
        allow the TSF to generate its own audit trail, which does not impede the MDF from enforcing
        its own security functionality.</con-mod>
      <con-mod ref="fau-sel-1-agent">This SFR requires the TSF to have the ability to limit the auditable events it generates
        for MDM Agent functionality. Since this applies exclusively to MDM Agent functionality, it does not conflict with the Base-PP events
        which must always be audited.</con-mod>
      <con-mod ref="fia-enr-ext-2"> This SFR requires the MDM Agent to record data
        that it receives from the OE. It does not need to use any functionality
        defined in the Base-PP to do this, and doing this does not prevent the
        enforcement of any security requirements from the Base-PP. </con-mod>
      <con-mod ref="fmt-pol-ext-2"> This SFR requires the MDM Agent to use a
        digital signature algorithm to validate data that it receives from the OE. 
        To do this, the MDM Agent will use the functionality defined
        by the Base-PP in FCS_COP.1/SIGN.</con-mod>
      <con-mod ref="fmt-smf-ext-4"> This SFR defines the ability of the MDM Agent
        to interact with the underlying operating system to execute the management functions defined by
        FMT_MOF_EXT.1 in the Base-PP. The Base-PP does not preclude administration being performed in this manner.</con-mod>
      <con-mod ref="fmt-unr-ext-1"> This SFR defines the functions performed by the MDM Agent when unenrolled from an MDM. The Base-PP
        defines FMT_SMF_EXT.1 which allows for assigned management functions to be specified. This can include unenrollment behavior as defined 
        by FMT_UNR_EXT.1. </con-mod>
      <con-mod ref="fau-stg-ext-3"> This SFR defines the ability of the MDM Agent
        to store generated audit data in platform-provided audit storage. The Base-PP defines the capability for 
        audit storage in FDP_ACF_EXT.1.</con-mod>
      <con-mod ref="fpt-net-ext-1"> This SFR defines the ability of the MDM Agent
        to maintain information about its last successful connection with the environmental MDM Server 
        (i.e., the last successful invocation of the trusted channel for
        that interface, as defined in FTP_ITC_EXT.1 of the Base-PP). It does not
        need to use any functionality defined in the Base-PP to do this, and doing
        this does not prevent the enforcement of any security requirements from the Base-PP.</con-mod>
    </base-pp>
    <man-sfrs>
      
      
      <!-- Audit table for mandatory requirements  -->
      <sec:ss-audit-table title="Auditable Events for Mandatory SFRs">
        <h:p>
          The auditable events specified in this PP-Module are included in an ST 
          if the incorporating PP, cPP, or PP-Module supports audit event reporting through FAU_GEN.1,
          and if all other criteria in the incorporating PP or PP-Module are met.
        </h:p>
        <audit-table id="at-man-audit" table="mandatory">
          <h:div class="table-caption"><ctr ctr-type="Table" id="atref-mandatory">: Auditable Events for Mandatory SFRs</ctr></h:div>
        </audit-table>
      </sec:ss-audit-table>
      
      <sec:man_fau title="Security Audit (FAU)">
        <ext-comp-def fam-id="FAU_ALT_EXT" title="MDM Alerts">
          <mod-def> This family is defined in the MDM
            Base-PP. This PP-Module augments the extended family
            by adding one additional component, FAU_ALT_EXT.2. This new component and its impact on
            the extended family’s component leveling are shown below; reference the 
            MDM PP for all other definitions for this family.<h:br/><h:br/> </mod-def>
        </ext-comp-def>
        <f-component cc-id="fau_alt_ext.2" id="fau-alt-ext-2" name="Agent Alerts">
          <consistency-rationale/>
          <comp-lev>requires the TSF to define when and how an MDM Agent generates
            alerts and transmits them to an MDM Server based on its
            activity.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <h:ul>
              <h:li>Ability to configure the specific events that result in generation of
                alerts.</h:li>
            </h:ul>
          </management>
          <audit> The following actions should be auditable if FAU_GEN Security audit data
            generation is included in the PP/ST:<h:ul>
              <h:li>Minimal: Success or failure of sending alert. </h:li>
            </h:ul>
          </audit>
          <dependencies> FAU_ALT_EXT.1 Server Alerts<h:br/> [FPT_ITT.1 Basic Internal TSF Data
            Transfer Protection; or<h:br/> FTP_ITC.1 Inter-TSF Trusted Channel] </dependencies>
          <f-element>
            <title>The MDM Agent shall provide an alert via the trusted channel to
              the MDM Server in the event of any of the following audit events: <h:ul>
                <h:li>successful application of MDM policies,</h:li>
                <h:li>
                  <selectables>
                    <selectable>receiving</selectable>
                    <selectable>generating</selectable>
                  </selectables> periodic reachability events, </h:li>
                <h:li><selectables linebreak="yes">
                  <selectable id="change-in-enrollment-state">change in enrollment state</selectable>
                  <selectable>failure to install an application from the MAS Server</selectable>
                  <selectable>failure to update an application from the MAS Server</selectable>
                  <selectable><assignable>other events</assignable></selectable>
                  <selectable>no other events</selectable>
                </selectables>.</h:li>
              </h:ul>
            </title>
            <note role="application"> The trusted channel is defined in FPT_ITT.1/INTER_XFER_AGENT of the Base-PP if the TOE claims the MDM PP,  
              FTP_ITC_EXT.1/MDFCHANNEL in this PP-Module if the TOE claims the 
              MDF PP, and FTP_ITC_EXT.1/OSCHANNEL in this PP-Module if the TOE claims the GPOS PP. 
              “Alert” in this requirement could be as simple as an audit record or
              a notification. If any prior alerts exist in the queue, per FAU_ALT_EXT.2.2, those
              alerts must be sent when the trusted channel is available.<h:br/><h:br/> This
              requirement is to ensure that the MDM Agent must notify the 
                MDM Server whenever one of the events listed above occurs. Lack of
              receipt of a successful policy installation indicates the failure of the policy
              installation.<h:br/><h:br/> The periodic reachability events ensure that either
              the MDM Agent responds to MDM Server polls to
              determine device network reachability, or the MDM Agent can be
              configured to regularly notify the MDM Server that it is reachable. The ST
              author must select “receiving” in the first case and “generating” in the second.
              The corresponding requirement for the MDM Server is FAU_NET_EXT.1 in
              the MDM
              PP.<h:br/><h:br/> The ST author must either
              assign further events or select the “no other events” option. Note that alerts may
              take time to reach the MDM Server, or not arrive, due to poor
              connectivity. <h:br/><h:br/>
            </note>            
          </f-element>
          <f-element>
            <title>The MDM Agent shall queue alerts if the trusted channel is not available.</title>
            <note role="application">If the trusted channel is not available, alerts must be queued. When the trusted channel becomes available, the queued alerts must be sent.<h:br/><h:br/>
            </note>
            <aactivity>
              <TSS>                  
                  The evaluator shall examine the TSS and verify that it describes how the alerts are implemented.<h:br/><h:br/> 
                  The evaluator shall examine the TSS and verify that it describes how the candidate policy updates are obtained and the actions that take place for successful (policy update installed) and unsuccessful (policy update not installed) cases. The software components that are performing the processing must also be identified in the TSS and verified by the evaluator.<h:br/><h:br/> 
                  The evaluator shall also ensure that the TSS describes how reachability events are implemented, and if configurable, are selected in FMT_SMF_EXT.4.2. The evaluator shall verify that this description clearly indicates whether the MDM Agent or MDM Server initiates reachability events.<h:br/><h:br/> 
                  The evaluator shall ensure that the TSS describes under what circumstances, if any, the alert may not be generated (e.g., the device is powered off or disconnected from the trusted channel), how alerts are queued, and the maximum amount of storage for queued messages.<h:br/><h:br/>
              </TSS>
              <Guidance>
                <h:p>There are no guidance EAs for this component.</h:p>
              </Guidance>
              <Tests>
                  <testlist>
                      <test>The evaluator shall perform a policy update from the test environment MDM Server. The evaluator shall verify the MDM Agent accepts the update, makes the configured changes, and reports the success of the policy update back to the MDM Server.</test>
                      <test>The evaluator shall perform each of the actions listed in FAU_ALT_EXT.2.1 and verify that the alert does in fact reach the MDM Server.</test>
                      <test>The evaluator shall configure the MDM Agent to perform a network reachability test, both with and without such connectivity and ensure that results reflect each.</test>
                      <test>The evaluator shall remove network connectivity from the MDM Agent and generate an alert or event as defined in FAU_ALT_EXT.2.1. The evaluator shall restore network connectivity to the MDM Agent and verify that the alert generated while the TOE was disconnected is sent by the MDM Agent upon re-establishment of the connectivity.</test>
                  </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Success or failure of sending alert.</audit-event-descr>
            <audit-event-info>No additional information.</audit-event-info>
          </audit-event>
        </f-component>
        <f-component cc-id="fau_gen.1" id="fau-gen-1-agent" name="Audit Data Generation" iteration="AGENT">
          <consistency-rationale/>
          <f-element>
            <title>The <h:b>MDM Agent</h:b> shall <h:b><selectables>
                <selectable>invoke platform-provided functionality</selectable>
                <selectable>implement functionality</selectable>
            </selectables></h:b> to generate audit data of the
              following auditable events: <h:ol type="a">
                <h:li>Startup and shutdown of the <h:b>MDM Agent</h:b>;</h:li>
                <h:li>All auditable events for the [<h:i>not specified</h:i>] level of audit; and</h:li>
                <h:li>[<h:i>MDM policy updated, any modification commanded by the 
                  MDM Server, specifically defined auditable events listed in 
                  <xref to="at-man-audit"/> and <selectables>
                    <selectable><xref to="at-mdf-addnl"/></selectable>
                    <selectable><xref to="at-mdm-addnl"/></selectable>
                    <selectable><xref to="at-gpos-addnl"/></selectable>
                    <selectable><xref to="at-feat-based"/></selectable>
                    <selectable>no other tables</selectable></selectables>, 
                  and <selectables>
                  <selectable><assignable>other events</assignable></selectable>
                  <selectable>no other events</selectable>
                </selectables></h:i>].</h:li>
              </h:ol>
            </title>
            <note role="application"> This requirement outlines the information to be included in
              the MDM Agent’s audit data. For each claimed SFR, any corresponding auditable events must be claimed.
              The auditable events are included in different tables because SFRs depend on the claimed Base-PP or supported TOE implementation;
              the ST author selects all tables that contain an SFR that the TOE claims.<h:br/><h:br/>
              If “MDM policy updated” is selected, it must indicate that an update to the policy occurred.
              The event record need not contain the differences between the prior policy
              and the new policy; optionally, the specific changes to policy that were included in
              that update may be detailed. All updates to policy should trigger this alert.
              Modifications commanded by the MDM Server are those commands listed
              in FMT_SMF.1.1.<h:br/><h:br/> The selection for the FMT_UNR_EXT.1 auditable event
              in the Auditable Events table corresponds to the selection in FMT_UNR_EXT.1. If “apply
              remediation actions” is selected in FMT_UNR_EXT.1, then the ST
              author selects “attempt to unenroll” in FAU_GEN.1.1/AGENT Auditable Events table for
              FMT_UNR_EXT.1; otherwise, "none" is selected.
              <!-- 
              <h:br/><h:br/>
              <h:b><ctr id="audit" ctr-type="Table"> Auditable Events</ctr></h:b>
              <h:table style="margin-top:0px;white-space:10px">
                <h:TR>
                  <h:TH>Requirement</h:TH>
                  <h:TH>Auditable Events</h:TH>
                  <h:TH>Additional Audit Record Contents</h:TH>
                </h:TR>
                <h:TR>
                  <h:TD>FAU_ALT_EXT.2</h:TD>
                  <h:TD>Success/failure of sending alert.</h:TD>
                  <h:TD>No additional information.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FAU_GEN.1/AGENT</h:TD>
                  <h:TD>None.</h:TD>
                  <h:TD>N/A</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FAU_SEL.1/AGENT</h:TD>
                  <h:TD>All modifications to the audit configuration that occur while the audit
                    collection functions are operating.</h:TD>
                  <h:TD>No additional information.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FCS_STG_EXT.4/<h:br/> FCS_STG_EXT.1/MDMKEYS</h:TD>
                  <h:TD>None.</h:TD>
                  <h:TD/>
                </h:TR>
                <h:TR>
                  <h:TD rowspan="3">FCS_TLSC_EXT.1</h:TD>
                  <h:TD>Failure to establish a TLS session.</h:TD><h:TD>Reason for failure.</h:TD></h:TR>
                <h:TR><h:TD>Failure to verify presented identifier.</h:TD><h:TD>Presented identifier and reference identifier.</h:TD></h:TR>
                <h:TR><h:TD>Establishment/termination of a TLS session.</h:TD><h:TD>Non-TOE endpoint of connection.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FIA_ENR_EXT.2</h:TD>
                  <h:TD>Enrollment in management.</h:TD>
                  <h:TD>Reference identifier of MDM Server.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FMT_POL_EXT.2</h:TD>
                  <h:TD>Failure of policy validation.</h:TD>
                  <h:TD>Reason for failure of validation.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FMT_SMF_EXT.4</h:TD>
                  <h:TD>Outcome (Success/failure) of function.</h:TD>
                  <h:TD>No additional information.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FMT_UNR_EXT.1.1</h:TD>
                  <h:TD>
                    <selectables>
                      <selectable>Attempt to unenroll</selectable>
                      <selectable>none</selectable>
                    </selectables>
                  </h:TD>
                  <h:TD>No additional information.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FTP_ITC_EXT.1/MDFCHANNEL</h:TD>
                  <h:TD>Initiation and termination of trusted channel.</h:TD>
                  <h:TD>Trusted channel protocol. Non-TOE endpoint of connection.</h:TD>
                </h:TR>
              </h:table>
              <h:br/><h:br/>
               -->
            </note>            
          </f-element>
          <f-element>
            <title>The <selectables>
                <selectable>TSF</selectable>
                <selectable>TOE platform</selectable>
            </selectables> shall record within the <h:b>MDM Agent</h:b> audit data at
              least the following information: <h:ol type="a">
                <h:li>Date and time of the event, type of event, subject identity (if applicable), and the outcome 
                  (success or failure) of the event<h:b>, and additional information in 
                  <xref to="at-man-audit"/> and <selectables>
                    <selectable><xref to="at-mdf-addnl"/></selectable>
                    <selectable><xref to="at-mdm-addnl"/></selectable>
                    <selectable><xref to="at-gpos-addnl"/></selectable>
                    <selectable><xref to="at-feat-based"/></selectable>
                    <selectable>no other tables</selectable></selectables>; </h:b></h:li>         
                <h:li>For each audit event type, based on the auditable event definitions of the functional components 
                  included in the PP, PP-Module, functional package or ST, <assignable>other audit relevant information</assignable>.</h:li>
              </h:ol>
            </title>
            <note role="application">All audits must contain at least the information mentioned in
              FAU_GEN.1.2/AGENT, but may contain more information which can be assigned. The ST author must identify which information
              in the given audit data that is populated by the MDM Agent and 
              which is populated by the MDM Agent’s platform.<h:br/><h:br/>
            </note>
            <aactivity>
              <TSS>
                  The evaluator shall check the TSS and ensure that it provides a format for audit
                  data. Each audit data format type must be covered, along with a brief description of each field. <h:br/><h:br/> 
                  If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported platform) 
                  how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the MDM Agent; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).<h:br/><h:br/> 
              </TSS>
              <Guidance>
                <h:p>There are no guidance EAs for this component.</h:p>
              </Guidance>
              <Tests>
                  The evaluator shall use the TOE to perform the auditable
                  events defined in the Auditable Events table in FAU_GEN.1.1/AGENT and shall observe that
                  accurate audit data are generated with contents and formatting consistent with
                  those described in the TSS. Note that this testing can be
                  accomplished in conjunction with the testing of the security mechanisms
                  directly.<h:br/><h:br/>                                 
              </Tests>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        <f-component cc-id="fau_sel.1" id="fau-sel-1-agent" name="Security Audit Event Selection" iteration="AGENT">
          <consistency-rationale/>
          <f-element>
            <title>The TSF shall <h:b><selectables>
                <selectable>invoke platform-provided functionality</selectable>
                <selectable>implement functionality</selectable>
            </selectables></h:b> to select the set of events to be audited from the set of all auditable
              events based on the following attributes: <h:ol type="a">
                <h:li>[<h:i>event type</h:i>]</h:li>
                <h:li>[<h:i>success of auditable security events, failure of auditable security events, 
                  <assignable>other attributes</assignable></h:i>].</h:li>
              </h:ol></title>
            <note role="application">The intent of this requirement is to identify all criteria that
              can be selected to trigger an audit event. For the ST author, the
              assignment is used to list any additional criteria that may be used but are not captured by the selection. This selection may be
              configured by the MDM Server.<h:br/><h:br/>
            </note>
            <aactivity>
              <TSS>If "invoke platform-provided functionality" is selected, the evaluator shall
                examine the TSS to verify that it
                describes (for each supported platform) how this functionality is invoked. It should
                be noted that this may be through a mechanism that is not implemented by the MDM
                Agent; nonetheless, that mechanism will be identified in the TSS
                as part of this evaluation activity.<h:br/><h:br/>
              </TSS>
              <Guidance>The evaluator shall examine the operational guidance to determine that it
                contains instructions on how to define the set of auditable events as well as
                explains the syntax for multi-value selection (if applicable). The evaluator shall
                also verify that the operational guidance shall identify those audit records that
                are always recorded, regardless of the selection criteria currently being
                enforced.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>For each attribute listed in the requirement, the evaluator shall devise a
                    test to show that selecting the attribute causes only audit events with that
                    attribute (or those that are always recorded, as identified in the
                    administrative guidance) to be recorded.
                  </test>
                  <test>[conditional]: If the TSF supports specification of more complex audit
                    pre-selection criteria (e.g., multiple attributes, logical expressions using
                    attributes) then the evaluator shall devise tests showing that this capability
                    is correctly implemented. The evaluator shall also, in the test plan, provide a
                    short narrative justifying the set of tests as representative and sufficient to
                    exercise the capability.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>All modifications to the audit configuration that occur while the audit collection functions are operating.</audit-event-descr>
            <audit-event-info>No additional information.</audit-event-info>
          </audit-event>
        </f-component>
      </sec:man_fau>
      <sec:man_fia title="Identification and Authentication (FIA)">
        <ext-comp-def title="Enrollment" fam-id="FIA_ENR_EXT">
          <mod-def> This family is defined in the MDM
            Base-PP. This PP-Module augments the extended family
            by adding one additional component, FIA_ENR_EXT.2. This new component and its impact on
            the extended family’s component leveling are shown below; reference the 
            MDM PP for all other definitions for this family.<h:br/><h:br/> </mod-def>
        </ext-comp-def>
        <f-component cc-id="fia_enr_ext.2" id="fia-enr-ext-2" name="Agent Enrollment of Mobile Device into Management">
          <consistency-rationale/>
          <comp-lev> requires the TSF to record specific information about the MDM
            Server (i.e., the entity that is enrolling it) during the enrollment process.</comp-lev>
          <management>There are no management functions foreseen.</management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:<h:ul>
              <h:li>Minimal: Completion of enrollment process.</h:li>
            </h:ul>
          </audit>
          <dependencies>FIA_ENR_EXT.1 Enrollment of Mobile Device into Management</dependencies>
          <f-element>
            <title>The MDM Agent shall record the reference identifier of the
                MDM Server during the enrollment process. </title>
            <note role="application">The reference identifier of the MDM Server
              may be the Distinguished Name, Domain Name, or the IP address of the 
                MDM Server. This requirement allows the specification of the information
              to be to be used to establish a network connection and the reference identifier for
              authenticating the trusted channel between the MDM Server and 
                MDM Agent, as defined in the MDM PP.<h:br/><h:br/>
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the TSS to verify that it describes
                which types of reference identifiers are acceptable and how the identifier is
                specified (e.g. preconfigured in the MDM Agent, by the user, by
                the MDM Server, in a policy).<h:br/><h:br/>
              </TSS>
              <Guidance>The evaluator shall examine the operational guidance to verify that it
                describes how to configure the reference identifier of the MDM
                Server’s certificate and, if different than the reference identifier, the Domain
                Name or IP address (for connectivity) of the MDM
                Server.<h:br/><h:br/>
              </Guidance>
              <Tests>The evaluator shall follow the operational guidance to establish the reference
                identifier of the MDM Server on the MDM Agent
                and in conjunction with other evaluation activities verify that the 
                  MDM Agent can connect to the MDM Server and validate
                the MDM Server’s certificate.<h:br/><h:br/>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Enrollment in management.</audit-event-descr>
            <audit-event-info>Reference identifier of the MDM Server.</audit-event-info>
          </audit-event>
        </f-component>
      </sec:man_fia>
      <sec:man_fmt title="Security Management (FMT)">
        <ext-comp-def title="Trusted Policy Update" fam-id="FMT_POL_EXT">
          <mod-def> This family is defined in the MDM
            Base-PP. This PP-Module augments the extended family
            by adding one additional component, FMT_POL_EXT.2. This new component and its impact on
            the extended family’s component leveling are shown below; reference the 
            MDM PP for all other definitions for this family.<h:br/><h:br/></mod-def>
        </ext-comp-def>
        <f-component cc-id="fmt_pol_ext.2" id="fmt-pol-ext-2" name="Agent Trusted Policy Update">
          <consistency-rationale/>
          <comp-lev> requires the TSF to verify the validity of the source of a policy before
            applying it.</comp-lev>
          <management>There are no management functions foreseen.</management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:<h:ul>
              <h:li>Minimal: Failure to validate policy.</h:li>
            </h:ul>
          </audit>
          <dependencies>FCS_COP.1 Cryptographic Operation<h:br/> FMT_POL_EXT.1 Trusted Policy
            Update </dependencies>
          <f-element>
            <title>The MDM Agent shall only accept policies and policy updates
              that are digitally signed by a private key that has been authorized for policy updates
              by the MDM Server. </title>
            <note role="application">The intent of this requirement is to cryptographically tie the
              policies to the enterprise that mandated the policy, not to protect the policies in
              transit, as this is addressed by other SFRs (FPT_ITT.1/INTER_XFER_AGENT in the MDM
              Base PP or the Additional SFR
              FTP_ITC_EXT.1/MDFCHANNEL or FTP_ITC_EXT.1/OSCHANNEL, depending on the claimed Base-PP). 
              This is especially critical for
              users who connect to multiple enterprises.<h:br/><h:br/> Policies must be
              digitally signed by the enterprise using the algorithms in
              FCS_COP.1/SIGN_ALG in the MDM PP.<h:br/><h:br/>
              The signing private key is associated with a certificate or raw public key used by the MDM Agent to verify the signature on the policy.
            </note>           
          </f-element>
          <f-element>
            <title>The MDM Agent shall not install policies if the signature check fails.</title>
            <aactivity>
                <TSS>
                The evaluator shall ensure that the TSS describes how the candidate policies are obtained by the MDM Agent, the processing associated with verifying the digital signature of the policy updates, and the actions that take place for successful (signature was verified) and unsuccessful (signature could not be verified) cases. The software components that are performing the processing must also be identified in the TSS and verified by the evaluator.<h:br/><h:br/>
                </TSS>
              <Guidance>
                <h:p>There are no guidance EAs for this component.</h:p>
              </Guidance>
              <Tests> 
                  This evaluation activity is performed in conjunction with the evaluation activity for FIA_X509_EXT.1 and FIA_X509_EXT.2 as defined in the Base-PPs.<h:br/><h:br/>
                  <testlist>
                      <test>The evaluator shall perform a policy update from an available configuration interface (such as through a test MDM Server). The evaluator shall verify the update is signed and is provided to the MDM Agent. The evaluator shall verify the MDM Agent accepts the digitally signed policy.</test>
                      <test>The evaluator shall perform a policy update from an available configuration interface (such as through a test MDM Server). The evaluator shall provide an unsigned and an incorrectly signed policy to the MDM Agent. The evaluator shall verify the MDM Agent does not accept the digitally signed policy.</test>
                  </testlist>            
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Failure of policy validation.</audit-event-descr>
            <audit-event-info>Reason for failure of validation.</audit-event-info>
          </audit-event>
        </f-component>
        <ext-comp-def title="Specification of Management Functions" fam-id="FMT_SMF_EXT">
          <mod-def> This family is defined in the MDF Base-PP. This 
              PP-Module augments the extended family by adding one additional component,
            FMT_SMF_EXT.4. This new component and its impact on the extended family’s component
            leveling are shown below; reference the MDF PP for all other definitions for this
            family.<h:br/><h:br/> </mod-def>
        </ext-comp-def>
        <f-component cc-id="fmt_smf_ext.4" id="fmt-smf-ext-4" name="Specification of Management Functions">
          <!-- Note: Changed to .4 to avoid conflict with MDM Server -->
          <consistency-rationale> </consistency-rationale>
          <comp-lev> requires the TSF to support the execution of certain management functions that
            require interfacing with other TOE components.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT:<h:ul>
              <h:li>Execution of management functions.</h:li>
              <h:li>Configuration of management functions behavior.</h:li>
            </h:ul>
          </management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:<h:ul>
              <h:li>Minimal: Successful and failed execution of management functions.</h:li>
            </h:ul>
          </audit>
          <dependencies>FCS_CKM.1 Cryptographic Key Generation</dependencies>
          <f-element>
            <title>The MDM Agent shall be capable of interacting with the platform
              to perform the following functions: <h:ul>
                <h:li><selectables>
                  <selectable>import the certificates to be used for authentication of MDM
                    Agent communications</selectable>
                <selectable>import the server public key</selectable></selectables>,</h:li>
                <h:li><selectables>
                    <selectable>administrator-provided management functions in MDF PP</selectable>
                    <selectable>administrator-provided device management functions in MDM PP</selectable>
                  <selectable>administrator-provided device management functions in GPOS PP</selectable>
                  </selectables></h:li>
                <h:li><selectables>
                    <selectable><assignable>additional functions</assignable></selectable>
                    <selectable> no additional functions</selectable>
                  </selectables>.</h:li>
              </h:ul>
            </title>
            <note role="application"> This requirement captures all the configuration functionality
              in the MDM Agent to configure the underlying MD with the
              configuration policies sent from the MDM Server to the MDM Agent. The
                ST author selects the Base-PP (MDF PP, MDM PP, or GPOS PP) as the source of the management functions.<h:br/><h:br/> The
              administrator-provided management functions in the MDF PP are specified
              in the "Admin Only" column of Table 7 in MDF PP and in FPT_TUD_EXT.1 (for version
              queries). The administrator-provided device management functions in the MDM
              PP are specified in FMT_SMF.1/SERVER_CONF_AGENT; the functions in the selection
              of FMT_SMF.1/SERVER_CONF_AGENT in the MDM
              PP are required to correspond to the functions available on the
              platforms supported by the MDM Agent. 
              The administrator-provided management functions in the GPOS PP are specified in FMT_SMF_EXT.1.
              <h:br/><h:br/> The 
                ST author can add more commands and configuration policies by completing
              the assignment statement; the device must support these additional commands or
              configuration policies.<h:br/><h:br/> The MDM Agent must configure the platform based
              on the commands and configuration policies received from the MDM
              Server. The ST author must not claim any functionality not provided
              by the supported device. All selections and assignments performed by the
                ST author in this requirement should match the selections and
              assignments of the validated MDF or GPOS ST.<h:br/><h:br/>
            </note>           
          </f-element>
          <f-element>
            <title>The MDM Agent shall be capable of performing the following
              functions: <h:ul>
                <h:li>enroll in management</h:li>
                <h:li>configure whether users can unenroll from management</h:li>
                <h:li>
                  <selectables>
                    <selectable>configure periodicity of reachability events</selectable>
                    <selectable><assignable>other management functions</assignable></selectable>
                    <selectable>no other functions</selectable>
                  </selectables>.</h:li>
              </h:ul></title>
            <note role="application"> This requirement captures all of the configuration in the
                MDM Agent for configuration of itself.<h:br/><h:br/> If the
                MDM Agent is part of a MD, enrollment is a single
              function both of the MDM Agent and of the device
              (FMT_SMF_EXT.4.1).<h:br/><h:br/> If the MDM Agent is an
              application developed separately from a MD, the MDM
              Agent performs the function “enroll in management” by registering itself to the MD as an administrator.
              The MDM Agent itself is enrolled in management by configuring the MDM
              Server to which the MDM Agent answers.<h:br/><h:br/> If the MDM
              Agent does not support unenrollment prevention, remediation actions should be applied
              upon unenrollment (per FMT_UNR_EXT.1).<h:br/><h:br/> If the MDM Agent generates
              periodic reachability events in FAU_ALT_EXT.2.1 and the periodicity of these events is
              configurable, “configure periodicity of reachability events” must be
              selected.<h:br/><h:br/>
            </note> 
            <aactivity>
                <!-- TODO: Need to move below sentence -->
                This assurance activity may be performed in conjunction with other assurance
                activities in the Base-PP.<h:br/><h:br/>
                
              <TSS> 
                  The evaluator shall verify that the assigned functions are described in the TSS and that these functions are documented as supported by the platform. The evaluator shall examine the TSS to verify that any differences between management functions and policies for each supported MD are listed.<h:br/><h:br/>
                  The evaluator shall verify that the TSS describes the methods in which the MDM Agent can be enrolled.<h:br/><h:br/> 
                  The TSS description shall make it clear whether the MDM Agent supports multiple interfaces for enrollment and configuration (for example, both remote configuration and local configuration).<h:br/><h:br/>                  
              </TSS>
              <Guidance> 
                  The evaluator shall verify the AGD guidance includes detailed instructions for configuring each function in this requirement.<h:br/><h:br/> 
                  If the MDM Agent is a component of the MDM system (i.e., MDM Server is the Base-PP), the evaluator shall verify, by consulting documentation for the claimed MD platforms, that the configurable functions listed for the MDM Agent are supported by the platforms.<h:br/><h:br/> 
                  If the MDM Agent supports multiple interfaces for configuration (for example, both remote configuration and local configuration), the operational guidance makes it clear whether some functions are restricted to certain interfaces.<h:br/><h:br/>                
              </Guidance>
              <Tests>
                <testlist>
                    <test>In conjunction with the evaluation activities in the Base-PP, the evaluator shall attempt to configure each 
                      administrator-provided management function and shall verify that the MD executes the commands and enforces the policies.</test>
                  <test>[conditional: if "import the certificates to be used for authentication of MDM Agent communications" is selected in FMT_SMF_EXT.4.1, then] 
                    The evaluator shall configure the MDM Agent authentication certificate in accordance with the configuration guidance. 
                    The evaluator shall verify that the MDM Agent uses this certificate in performing the tests for the MDM PP SFR FPT_ITT.1/INTER_XFER_AGENT 
                    (if the MDM PP is the Base-PP),
                    the Additional SFR FTP_ITC_EXT.1/MDFCHANNEL (if the MDF PP is the Base-PP),
                    or the Additional SFR FTP_ITC_EXT.1/OSCHANNEL (if the GPOS PP is the Base-PP).</test>
                    <test>In conjunction with other evaluation activities, the evaluator shall attempt to enroll the MDM Agent in management with each interface identified in the TSS, and verify that the MDM Agent can manage the device and communicate with the MDM Server.</test>
                    <test>[conditional] In conjunction with the evaluation activity for FAU_ALT_EXT.2.1, the evaluator shall configure the periodicity for reachability events for several configured time periods and verify that the MDM Server receives alerts on that schedule.</test>
                  <test>[conditional] The evaluator shall design and perform tests to demonstrate that the assigned function may be configured and that the intended behavior of the function is enacted by the MD.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Outcome (success or failure) of function.</audit-event-descr>
            <audit-event-info>No additional information.</audit-event-info>
          </audit-event>
        </f-component>
        <ext-comp-def title="Unenrollment" fam-id="FMT_UNR_EXT">
          <fam-behavior> Components in this family define requirements for TSF behavior when a user
            attempts to unenroll the TOE from an MDM.</fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fmt_unr_ext.1" id="fmt-unr-ext-1" name="User Unenrollment Prevention">
          <consistency-rationale/>
          <comp-lev> requires the TSF either to prevent unenrollment entirely or to take some
            corrective action in the event that an unenrollment is initiated.</comp-lev>
          <management>There are no management functions foreseen.</management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:<h:ul>
              <h:li>Minimal: Unenrollment from MDM.</h:li>
            </h:ul>
          </audit>
          <dependencies> [FIA_ENR_EXT.1 Enrollment of Mobile Device into Management; or<h:br/>
            FMT_MOF_EXT.1 Management of Functions Behavior] </dependencies>
          <f-element>
            <title>The MDM Agent shall provide a mechanism to enforce the
              following behavior upon an attempt to unenroll the device from management: <selectables>
                <selectable id="prevent-unenrollment">prevent the unenrollment from occurring</selectable>
                <selectable id="apply-remediation">apply remediation actions</selectable>
              </selectables>.
            </title>
            <note role="application">Unenrolling is the action of transitioning from the enrolled
              state to the unenrolled state. If preventing the user from unenrolling is
              configurable, administrators configure whether users are allowed to unenroll through
              the MDM Server.<h:br/><h:br/> For those configurations where
              unenrollment is allowed, for example a BYOD usage, the MDF PP describes remediation
              actions performed upon unenrollment, such as wiping enterprise data, in
              FMT_SMF_EXT.2.1. The GPOS PP does not explicitly describe the case of unenrollment but 
              a GPOS has interfaces that an MDM Agent can invoke to perform 
              the desired unenrollment functionality. The MDM Agent is limited to those actions
              supported by the device on which the MDM Agent is operating. <h:br/><h:br/>
            </note>
            <aactivity>
              <TSS> The evaluator shall ensure that the TSS describes the
                mechanism used to prevent users from unenrolling or the remediation actions applied
                when unenrolled.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall ensure that the administrative guidance instructs
                administrators on configuring the unenrollment prevention in each available
                configuration interface. If any configuration allows users to unenroll, the guidance
                also describes the actions that unenroll the MDM Agent.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>If ‘prevent the unenrollment from occurring’ is selected, the evaluator shall configure the MDM Agent according to the administrative guidance for each available configuration interface, attempt to unenroll the device, and verify that the attempt fails.
                  </test>
                  <test>If ‘apply remediation actions’ is selected, if any configuration allows the user to unenroll, the evaluator shall configure the MDM Agent to allow user unenrollment, attempt to unenroll, and verify that the remediation actions are applied.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event type="optional">
            <audit-event-descr>Attempt to unenroll</audit-event-descr>
            <audit-event-info>No additional information</audit-event-info>
          </audit-event>
        </f-component>
      </sec:man_fmt>
    </man-sfrs>
    <opt-sfrs/>
    <sel-sfrs/>
    <obj-sfrs/>
  
    
    <impl-dep-sfrs>
      
      <section id="sib-audit-table" title="Auditable Events for Implementation-Dependent SFRs">
        <audit-table id="at-feat-based" table="feat-based">
          <h:br/><h:b><ctr ctr-type="Table" pre="Table " id="atref-implbased">: Auditable Events for Implementation-Dependent SFRs</ctr></h:b>
        </audit-table>
      </section>
      
      <sec:ib_fau title="Security Audit (FAU)">
        <ext-comp-def title="Protected Audit Event Storage" fam-id="FAU_STG_EXT">
          <mod-def>This family is defined in the MDM
            Base-PP. This PP-Module augments the extended family
            by adding one additional component, FAU_STG_EXT.3. This new component and its impact on
            the extended family’s component leveling are shown below; reference the 
            MDM PP for all other definitions for this family.<h:br/><h:br/></mod-def>
        </ext-comp-def>
        <f-component cc-id="fau_stg_ext.3" id="fau-stg-ext-3" name="Security Audit Event Storage">
          <!-- Note: Name changed simply to avoid name collision with MDM Server -->
          <depends on="has-auditing"/>
          <consistency-rationale/>
          <comp-lev> requires the TSF to identify a location for audit record storage and the events
            that are stored at this location.</comp-lev>
          <management>There are no management functions foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FAU_GEN.1 Audit Data Generation</dependencies>
          <f-element>
            <title>The MDM Agent shall store MDM audit records in the platform-provided audit storage. </title>
            <aactivity>
              <TSS>The evaluator shall verify that the TSS description of the
                audit records indicates how the records are stored. The evaluator shall verify that
                the MDM Agent calls a platform-provided API to store audit records.<h:br/><h:br/>
              </TSS>
              <Guidance>
                <h:p>There are no guidance EAs for this component.</h:p>
              </Guidance>
              <Tests>
                <h:p>There are no test EAs for this component.</h:p>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event table="feat-based"/>
        </f-component>
      </sec:ib_fau>
      <sec:ib_fpt title="Protection of the TSF (FPT)">
        <ext-comp-def title="Network Reachability" fam-id="FPT_NET_EXT">
          <fam-behavior> Components in this family define requirements for tracking the availability
            of network components. </fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fpt_net_ext.1" id="fpt-net-ext-1" name="Network Reachability">
          <depends on="supports-reachability"/>
          <consistency-rationale/>
          <comp-lev> requires the TSF to keep track of failed attempts to communicate with a remote
            entity.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT:<h:br/>
            <h:ul>
              <h:li>Configuration of unreachability threshold.</h:li></h:ul>
          </management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:<h:ul>
              <h:li>Minimal: Reaching or exceeding unreachability threshold.</h:li></h:ul>
          </audit>
          <dependencies>FPT_STM.1 Reliable Time Stamps</dependencies>
          <f-element>
            <title>The TSF shall detect when a configurable <selectables>
              <selectable>positive integer of missed reachability events occur</selectable>
              <selectable>time limit is exceeded</selectable>
            </selectables> related to when the last successful connection with the server has been
              reached. </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS contains a description
                of how the MDM Agent determines how long it has been since the last successful
                connection with the MDM Server (i.e., total number of missed reachability events or
                time). If "positive integer of missed reachability events occur" is selected, the evaluator
                shall verify that the TSS contains a description of how often the
                reachability events are sent.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance instructs the
                administrator, if needed, how to configure the TOE to detect when
                the time since the last successful connection with the server has been
                reached.<h:br/><h:br/>
              </Guidance>
              <Tests> The evaluator shall configure the MDM Server configuration policy of the MDM Agent per
                FMT_SMF.1.1/SERVER_CONF_AGENT, function 56 in the MDM PP. The device shall be placed in airplane mode or otherwise have its 
                network capabilities disabled to prevent
                connectivity with the MDM Server. The evaluator shall verify that after the configured
                time, the remediation actions selected in function 56 occur.<h:br/><h:br/>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event table="feat-based">
            <audit-event-descr>MDM Server connection reaching or exceeding unavailability threshold.</audit-event-descr>
            <audit-event-info>No additional information.</audit-event-info>
          </audit-event>
        </f-component>
      </sec:ib_fpt>
      
    </impl-dep-sfrs>
  </sec:Security_Requirements>
  <appendix title="Implicitly Satisfied Requirements" id="satisfiedreqs"> 
    <h:div class="table-caption"><ctr ctr-type="Table" id="implicit-sfrs">: Implicitly Satisfied Requirements</ctr></h:div>
    <h:table>
      <h:tr>
        <h:th>Requirement</h:th>
        <h:th>Rationale for Satisfaction</h:th>
      </h:tr>
      <h:tr>
        <h:td>FMT_MTD.1 - Management of TSF Data</h:td>
        <h:td>
          FAU_SEL.1 has a dependency on FMT_MTD.1 because the configuration settings that determine what events are audited is considered to be TSF data. 
          While FAU_SEL.1 determines the extent to which the TOE’s audit function is configured, 
          it relies on FMT_MTD.1 to determine the administrative roles that are permitted to manipulate this data.
          <h:br/><h:br/>
          This is not applicable to the PP-Module because there is no management interface for a TOE user to interact with; instead, 
          all management functions are initiated by an MDM Server and performed by the MDM Agent that has sufficient privileges on the 
          underlying device to do this. 
          In this case, FIA_ENR_EXT.2 and FMT_POL_EXT.2 are sufficient to validate that the source of the policy data is 
          identified and authenticated before the policy change is accepted. 
          It is not necessary to define a management role associated with this function because the MDM Server does not need to assume a ‘role’ on the 
          TOE to communicate policy data; it is sufficient for the TSF to determine the policy is genuine.
        </h:td>
      </h:tr>
      <h:tr>
        <h:td>FPT_STM.1 - Reliable Time Stamps</h:td>
      <h:td>
        Regardless of whether the MDM Agent is part of an MDM Server or MD TOE, the MDM Agent itself will be installed on a device. 
        If the mobile device is part of the TOE, the MDF PP that it conforms to explicitly
        defines FPT_STM.1, which therefore satisfies the dependency in this case. If the mobile
        device is not part of the TOE, a reliable time source can still be assumed because all
        mobile devices must include some method to update time data from a cellular carrier network,
        and can also reasonably be assumed to include a method to update network time if it is
        instead connected to a network via WLAN radio (such as when in airplane mode).
      </h:td>
      </h:tr>
    </h:table>
  </appendix>

<appendix title="Use Case Templates" id="appdx-use-case-templates"/>

<!-- 
  <appendix id="use-case" title="Use Case Templates"> The following use case templates list those
    selections, assignments, and objective requirements that best support the use cases identified
    by this PP-Module. Note that the templates assume that all SFRs
    listed in Section 5 are included in the ST, not just those listed in the
    templates. These templates and deviations from the template should be identified in the Security
    Target to assist customers with making risk-based purchasing decisions. Products that do not
    meet these templates are not precluded from use in the scenarios identified by this PP-Module.
    <h:br/><h:br/> 
    Where selections for a particular requirement are not identified in a
    use case template, all available selections are equally applicable to the use case.<h:br/><h:br/>
    <usecase id="usecase1" title="Enterprise-owned device for general-purpose enterprise use">
      <description>
        <h:b>[Use Case 1] Enterprise-owned device for general-purpose enterprise use</h:b>
        <h:br/><h:br/> At this time no additional requirements are recommended for this use
        case.<h:br/><h:br/>
      </description>
    </usecase>
    <usecase title="Enterprise-owned device for specialized, high-security use" id="usecase2">
      <description>
        <h:b>[Use Case 2] Enterprise-owned device for specialized, high-security use</h:b>
        <h:table>
          <h:tr>
            <h:th>Requirement</h:th>
            <h:th>Action</h:th>
          </h:tr>
          <h:tr>
            <h:td>FAU_ALT_EXT.2.1 Function c</h:td>
            <h:td>Include in ST.</h:td>
          </h:tr>
          <h:tr>
            <h:td>FMT_UNR_EXT.1.1</h:td>
            <h:td>Select “prevent the unenrollment from occurring”.</h:td>
          </h:tr>
        </h:table>
        <h:br/><h:br/>
      </description>
    </usecase>
    <usecase title="Personally owned device for personal and enterprise use" id="usecase3">
      <description>
        <h:b>[Use Case 3] Personally owned device for personal and enterprise use</h:b>
        <h:table>
          <h:tr>
            <h:th>Requirement</h:th>
            <h:th>Action</h:th>
          </h:tr>
          <h:tr>
            <h:td>FMT_UNR_ENT.1.1</h:td>
            <h:td>Select “apply remediation actions”</h:td>
          </h:tr>
        </h:table>
        <h:br/><h:br/>
      </description>
    </usecase>
    <usecase title="Personally owned device for personal and limited enterprise" id="usecase4">
      <description><h:b>[Use Case 4] Personally owned device for personal and limited enterprise
          use</h:b><h:br/><h:br/> At this time no additional requirements are recommended for
        this use case.</description>
    </usecase>
  </appendix>
  
  -->
  <bibliography>
    <cc-entry/>
    <entry id="bibGPOS">
      <tag>GPOS PP</tag>
      <description><h:a
        href="https://www.niap-ccevs.org/static_html/protection-profile/469/OS%204.3%20PP/index.html">Protection
        Profile for General Purpose Operating Systems, Version 5.0</h:a>, September 27, 2022 <comment>Adjust
          date when finalized.</comment></description>
    </entry>      
    <entry id="bibMDF">
      <tag>MDF PP</tag>
      <description><h:a
        href="https://www.niap-ccevs.org/static_html/protection-profile/468/MDF%203.3%20PP/index.html">Protection
        Profile for Mobile Device Fundamentals, Version 4.0</h:a>, September 12, 2022 <comment>Adjust
          date when finalized.</comment></description>
    </entry>
    <entry id="bibMDM">
      <tag>MDM PP</tag>
      <description>
        <h:a
          href="https://www.niap-ccevs.org/static_html/protection-profile/428/-428-/index.html">Protection
          Profile for Mobile Device Management, Version 5.0, April 25, 2019 <comment>Adjust
            date when finalized.</comment></h:a>
      </description>
    </entry>
  </bibliography>


</Module>
